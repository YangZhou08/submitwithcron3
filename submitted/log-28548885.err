ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
datasets 2.19.1 requires fsspec[http]<=2024.3.1,>=2023.1.0, but you have fsspec 2024.5.0 which is incompatible.
Already on 'yangexp2'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
Traceback (most recent call last):
  File "/private/home/beidic/.conda/envs/griffin/bin/huggingface-cli", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/private/home/beidic/.conda/envs/griffin/lib/python3.12/site-packages/huggingface_hub/commands/huggingface_cli.py", line 51, in main
    service.run()
  File "/private/home/beidic/.conda/envs/griffin/lib/python3.12/site-packages/huggingface_hub/commands/user.py", line 98, in run
    login(token=self.args.token, add_to_git_credential=self.args.add_to_git_credential)
  File "/private/home/beidic/.conda/envs/griffin/lib/python3.12/site-packages/huggingface_hub/_login.py", line 111, in login
    _login(token, add_to_git_credential=add_to_git_credential, write_permission=write_permission)
  File "/private/home/beidic/.conda/envs/griffin/lib/python3.12/site-packages/huggingface_hub/_login.py", line 307, in _login
    raise ValueError("Invalid token passed!")
ValueError: Invalid token passed!
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
2024-06-03:14:41:34,215 INFO     [main.py:288] Verbosity set to INFO
2024-06-03:14:41:34,215 INFO     [main.py:288] Verbosity set to INFO
2024-06-03:14:41:34,215 INFO     [main.py:288] Verbosity set to INFO
2024-06-03:14:41:34,215 INFO     [main.py:288] Verbosity set to INFO
2024-06-03:14:41:34,217 INFO     [main.py:288] Verbosity set to INFO
2024-06-03:14:41:34,354 INFO     [main.py:288] Verbosity set to INFO
2024-06-03:14:41:34,367 INFO     [main.py:288] Verbosity set to INFO
2024-06-03:14:41:34,415 INFO     [main.py:288] Verbosity set to INFO
2024-06-03:14:41:39,917 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-06-03:14:41:39,920 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-06-03:14:41:39,926 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-06-03:14:41:39,926 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-06-03:14:41:39,926 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-7b-hf', 'griffin': False, 'check': False}
2024-06-03:14:41:39,926 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-7b-hf', 'griffin': False, 'check': False}
2024-06-03:14:41:39,942 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-06-03:14:41:39,946 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-06-03:14:41:39,946 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-7b-hf', 'griffin': False, 'check': False}
2024-06-03:14:41:40,988 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-06-03:14:41:40,994 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-06-03:14:41:40,994 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-7b-hf', 'griffin': False, 'check': False}
2024-06-03:14:41:41,076 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-06-03:14:41:41,082 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-06-03:14:41:41,082 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-7b-hf', 'griffin': False, 'check': False}
2024-06-03:14:41:41,242 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-06-03:14:41:41,246 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-06-03:14:41:41,246 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-7b-hf', 'griffin': False, 'check': False}
2024-06-03:14:41:41,396 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-06-03:14:41:41,401 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-06-03:14:41:41,401 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-7b-hf', 'griffin': False, 'check': False}
2024-06-03:14:41:41,402 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-06-03:14:41:41,406 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-06-03:14:41:41,406 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-7b-hf', 'griffin': False, 'check': False}
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:50<00:50, 50.92s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:53<00:53, 53.25s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:53<00:53, 53.23s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:52<00:52, 52.15s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:51<00:51, 51.99s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:52<00:52, 52.66s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:52<00:52, 52.55s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:53<00:53, 53.43s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:08<00:00, 31.04s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:08<00:00, 34.18s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 31.86s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 35.07s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 31.85s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 35.06s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:08<00:00, 31.37s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:08<00:00, 34.49s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:08<00:00, 31.53s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:08<00:00, 34.44s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:09<00:00, 31.52s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:09<00:00, 34.67s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 31.87s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 35.11s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:09<00:00, 31.60s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:09<00:00, 34.76s/it]
Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
2024-06-03:14:42:52,762 WARNING  [load.py:1631] Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
2024-06-03:14:42:52,765 WARNING  [cache.py:95] Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
2024-06-03:14:42:52,973 INFO     [xhuggingface.py:314] Using 8 devices with data parallelism
2024-06-03:14:42:53,068 INFO     [task.py:395] Building contexts for gsm8k on rank 7...
  0%|          | 0/164 [00:00<?, ?it/s]Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
2024-06-03:14:42:53,166 WARNING  [load.py:1631] Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
2024-06-03:14:42:53,166 WARNING  [load.py:1631] Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
2024-06-03:14:42:53,168 WARNING  [cache.py:95] Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
2024-06-03:14:42:53,168 WARNING  [cache.py:95] Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
 13%|█▎        | 22/164 [00:00<00:00, 210.45it/s]Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
2024-06-03:14:42:53,212 WARNING  [load.py:1631] Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
2024-06-03:14:42:53,213 WARNING  [cache.py:95] Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
2024-06-03:14:42:53,257 WARNING  [load.py:1631] Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
2024-06-03:14:42:53,259 WARNING  [cache.py:95] Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
2024-06-03:14:42:53,281 WARNING  [load.py:1631] Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
2024-06-03:14:42:53,283 WARNING  [cache.py:95] Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
2024-06-03:14:42:53,289 WARNING  [load.py:1631] Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
2024-06-03:14:42:53,290 WARNING  [cache.py:95] Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
2024-06-03:14:42:53,309 WARNING  [load.py:1631] Using the latest cached version of the dataset since gsm8k couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
2024-06-03:14:42:53,310 WARNING  [cache.py:95] Found the latest cached dataset configuration 'main' at /private/home/beidic/.cache/huggingface/datasets/gsm8k/main/0.0.0/e53f048856ff4f594e959d75785d2c2d37b678ee (last modified on Thu May 16 07:01:08 2024).
 27%|██▋       | 44/164 [00:00<00:00, 194.14it/s]2024-06-03:14:42:53,385 INFO     [task.py:395] Building contexts for gsm8k on rank 5...
2024-06-03:14:42:53,399 INFO     [task.py:395] Building contexts for gsm8k on rank 2...
  0%|          | 0/165 [00:00<?, ?it/s]  0%|          | 0/165 [00:00<?, ?it/s]2024-06-03:14:42:53,464 INFO     [task.py:395] Building contexts for gsm8k on rank 1...
 39%|███▉      | 64/164 [00:00<00:00, 159.87it/s]2024-06-03:14:42:53,480 INFO     [task.py:395] Building contexts for gsm8k on rank 0...
  0%|          | 0/165 [00:00<?, ?it/s] 13%|█▎        | 21/165 [00:00<00:00, 206.54it/s]  0%|          | 0/165 [00:00<?, ?it/s]2024-06-03:14:42:53,537 INFO     [task.py:395] Building contexts for gsm8k on rank 6...
  8%|▊         | 14/165 [00:00<00:01, 139.20it/s]  0%|          | 0/165 [00:00<?, ?it/s] 13%|█▎        | 21/165 [00:00<00:00, 208.95it/s]2024-06-03:14:42:53,587 INFO     [task.py:395] Building contexts for gsm8k on rank 3...
 49%|████▉     | 81/164 [00:00<00:00, 150.80it/s] 25%|██▌       | 42/165 [00:00<00:00, 207.63it/s]  8%|▊         | 14/165 [00:00<00:01, 137.57it/s]  0%|          | 0/165 [00:00<?, ?it/s]2024-06-03:14:42:53,636 INFO     [task.py:395] Building contexts for gsm8k on rank 4...
 17%|█▋        | 28/165 [00:00<00:01, 135.70it/s]  8%|▊         | 14/165 [00:00<00:01, 133.12it/s] 25%|██▌       | 42/165 [00:00<00:00, 209.17it/s]  0%|          | 0/165 [00:00<?, ?it/s] 59%|█████▉    | 97/164 [00:00<00:00, 145.40it/s] 38%|███▊      | 63/165 [00:00<00:00, 205.70it/s] 18%|█▊        | 29/165 [00:00<00:00, 139.53it/s]  9%|▉         | 15/165 [00:00<00:01, 140.47it/s] 25%|██▌       | 42/165 [00:00<00:00, 136.42it/s] 18%|█▊        | 29/165 [00:00<00:00, 138.18it/s] 38%|███▊      | 63/165 [00:00<00:00, 205.77it/s]  8%|▊         | 14/165 [00:00<00:01, 131.32it/s] 51%|█████     | 84/165 [00:00<00:00, 206.68it/s] 68%|██████▊   | 112/164 [00:00<00:00, 143.99it/s] 26%|██▌       | 43/165 [00:00<00:00, 137.65it/s] 18%|█▊        | 30/165 [00:00<00:00, 141.03it/s] 34%|███▍      | 56/165 [00:00<00:00, 136.43it/s] 51%|█████     | 84/165 [00:00<00:00, 206.76it/s] 27%|██▋       | 44/165 [00:00<00:00, 139.65it/s] 17%|█▋        | 28/165 [00:00<00:01, 134.21it/s] 64%|██████▎   | 105/165 [00:00<00:00, 207.51it/s] 77%|███████▋  | 127/164 [00:00<00:00, 142.99it/s] 35%|███▌      | 58/165 [00:00<00:00, 139.26it/s] 27%|██▋       | 45/165 [00:00<00:00, 140.01it/s] 42%|████▏     | 70/165 [00:00<00:00, 136.01it/s] 64%|██████▎   | 105/165 [00:00<00:00, 207.70it/s] 25%|██▌       | 42/165 [00:00<00:00, 134.84it/s] 36%|███▌      | 59/165 [00:00<00:00, 140.01it/s] 76%|███████▋  | 126/165 [00:00<00:00, 207.90it/s] 87%|████████▋ | 142/164 [00:00<00:00, 141.51it/s] 44%|████▍     | 73/165 [00:00<00:00, 140.31it/s] 36%|███▋      | 60/165 [00:00<00:00, 140.84it/s] 51%|█████     | 84/165 [00:00<00:00, 135.78it/s] 76%|███████▋  | 126/165 [00:00<00:00, 208.26it/s] 34%|███▍      | 56/165 [00:00<00:00, 135.53it/s] 44%|████▍     | 73/165 [00:00<00:00, 138.85it/s] 89%|████████▉ | 147/165 [00:00<00:00, 207.27it/s] 96%|█████████▌| 157/164 [00:01<00:00, 140.93it/s] 53%|█████▎    | 88/165 [00:00<00:00, 140.95it/s] 45%|████▌     | 75/165 [00:00<00:00, 141.35it/s] 59%|█████▉    | 98/165 [00:00<00:00, 135.99it/s]100%|██████████| 164/164 [00:01<00:00, 148.86it/s]
 89%|████████▉ | 147/165 [00:00<00:00, 207.51it/s]100%|██████████| 165/165 [00:00<00:00, 207.17it/s]
 42%|████▏     | 70/165 [00:00<00:00, 135.89it/s] 53%|█████▎    | 88/165 [00:00<00:00, 141.12it/s] 62%|██████▏   | 103/165 [00:00<00:00, 139.84it/s] 55%|█████▍    | 90/165 [00:00<00:00, 140.21it/s]100%|██████████| 165/165 [00:00<00:00, 208.17it/s]
 68%|██████▊   | 112/165 [00:00<00:00, 134.95it/s] 66%|██████▌   | 109/165 [00:00<00:00, 162.62it/s] 52%|█████▏    | 85/165 [00:00<00:00, 137.93it/s] 72%|███████▏  | 118/165 [00:00<00:00, 141.14it/s] 64%|██████▎   | 105/165 [00:00<00:00, 141.29it/s] 77%|███████▋  | 127/165 [00:00<00:00, 136.91it/s] 79%|███████▉  | 131/165 [00:00<00:00, 178.40it/s] 61%|██████    | 101/165 [00:00<00:00, 143.70it/s] 81%|████████  | 133/165 [00:00<00:00, 142.10it/s] 73%|███████▎  | 120/165 [00:00<00:00, 141.94it/s] 90%|████████▉ | 148/165 [00:01<00:00, 158.45it/s] 75%|███████▍  | 123/165 [00:00<00:00, 166.65it/s] 93%|█████████▎| 153/165 [00:00<00:00, 188.54it/s]100%|██████████| 165/165 [00:01<00:00, 148.62it/s]
100%|██████████| 165/165 [00:00<00:00, 165.85it/s]
 90%|████████▉ | 148/165 [00:01<00:00, 142.54it/s] 82%|████████▏ | 135/165 [00:00<00:00, 142.59it/s] 88%|████████▊ | 145/165 [00:00<00:00, 182.93it/s] 99%|█████████▉| 163/165 [00:01<00:00, 142.67it/s] 91%|█████████ | 150/165 [00:01<00:00, 142.20it/s]100%|██████████| 165/165 [00:01<00:00, 141.10it/s]
100%|██████████| 165/165 [00:01<00:00, 162.10it/s]
100%|██████████| 165/165 [00:01<00:00, 142.28it/s]
2024-06-03:14:42:59,304 INFO     [xevaluator.py:395] Running generate_until requests
2024-06-03:14:42:59,304 INFO     [xevaluator.py:395] Running generate_until requests
2024-06-03:14:42:59,304 INFO     [xevaluator.py:395] Running generate_until requests
2024-06-03:14:42:59,304 INFO     [xevaluator.py:395] Running generate_until requests
2024-06-03:14:42:59,304 INFO     [xevaluator.py:395] Running generate_until requests
2024-06-03:14:42:59,305 INFO     [xevaluator.py:395] Running generate_until requests
2024-06-03:14:42:59,305 INFO     [xevaluator.py:395] Running generate_until requests
2024-06-03:14:42:59,304 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/165 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/165 [00:13<37:18, 13.65s/it]Running generate_until requests:   1%|          | 2/165 [00:20<25:44,  9.48s/it]Running generate_until requests:   2%|▏         | 3/165 [00:29<25:58,  9.62s/it]Running generate_until requests:   2%|▏         | 4/165 [00:38<24:39,  9.19s/it]Running generate_until requests:   3%|▎         | 5/165 [00:46<23:36,  8.86s/it]Running generate_until requests:   4%|▎         | 6/165 [00:52<20:35,  7.77s/it]Running generate_until requests:   4%|▍         | 7/165 [00:54<15:57,  6.06s/it]Running generate_until requests:   5%|▍         | 8/165 [01:00<15:07,  5.78s/it]Running generate_until requests:   5%|▌         | 9/165 [01:03<13:12,  5.08s/it]Running generate_until requests:   6%|▌         | 10/165 [01:09<13:20,  5.16s/it]Running generate_until requests:   7%|▋         | 11/165 [01:20<18:10,  7.08s/it]Running generate_until requests:   7%|▋         | 12/165 [01:25<16:42,  6.55s/it]Running generate_until requests:   8%|▊         | 13/165 [01:29<14:34,  5.76s/it]Running generate_until requests:   8%|▊         | 14/165 [01:41<19:07,  7.60s/it]Running generate_until requests:   9%|▉         | 15/165 [01:45<15:58,  6.39s/it]Running generate_until requests:  10%|▉         | 16/165 [01:48<13:41,  5.51s/it]Running generate_until requests:  10%|█         | 17/165 [01:56<15:09,  6.15s/it]Running generate_until requests:  11%|█         | 18/165 [01:58<12:13,  4.99s/it]Running generate_until requests:  12%|█▏        | 19/165 [02:06<14:18,  5.88s/it]Running generate_until requests:  12%|█▏        | 20/165 [02:11<13:26,  5.56s/it]Running generate_until requests:  13%|█▎        | 21/165 [02:19<15:04,  6.28s/it]Running generate_until requests:  13%|█▎        | 22/165 [02:23<13:27,  5.64s/it]Running generate_until requests:  14%|█▍        | 23/165 [02:35<17:48,  7.52s/it]Running generate_until requests:  15%|█▍        | 24/165 [02:41<16:37,  7.07s/it]Running generate_until requests:  15%|█▌        | 25/165 [02:53<19:48,  8.49s/it]Running generate_until requests:  16%|█▌        | 26/165 [03:01<19:21,  8.35s/it]Running generate_until requests:  16%|█▋        | 27/165 [03:05<16:36,  7.22s/it]Running generate_until requests:  17%|█▋        | 28/165 [03:14<17:16,  7.57s/it]Running generate_until requests:  18%|█▊        | 29/165 [03:21<17:01,  7.51s/it]Running generate_until requests:  18%|█▊        | 30/165 [03:27<15:39,  6.96s/it]Running generate_until requests:  19%|█▉        | 31/165 [03:32<14:15,  6.39s/it]Running generate_until requests:  19%|█▉        | 32/165 [03:37<13:15,  5.98s/it]Running generate_until requests:  20%|██        | 33/165 [03:39<10:53,  4.95s/it]Running generate_until requests:  21%|██        | 34/165 [03:43<10:07,  4.63s/it]Running generate_until requests:  21%|██        | 35/165 [03:50<11:09,  5.15s/it]Running generate_until requests:  22%|██▏       | 36/165 [03:54<10:36,  4.93s/it]Running generate_until requests:  22%|██▏       | 37/165 [03:58<09:40,  4.54s/it]Running generate_until requests:  23%|██▎       | 38/165 [04:09<14:10,  6.69s/it]Running generate_until requests:  24%|██▎       | 39/165 [04:21<17:20,  8.26s/it]Running generate_until requests:  24%|██▍       | 40/165 [04:25<14:24,  6.92s/it]Running generate_until requests:  25%|██▍       | 41/165 [04:32<14:05,  6.82s/it]Running generate_until requests:  25%|██▌       | 42/165 [04:37<12:45,  6.23s/it]Running generate_until requests:  26%|██▌       | 43/165 [04:41<11:27,  5.63s/it]Running generate_until requests:  27%|██▋       | 44/165 [04:49<12:41,  6.29s/it]Running generate_until requests:  27%|██▋       | 45/165 [04:54<12:02,  6.02s/it]Running generate_until requests:  28%|██▊       | 46/165 [04:58<10:28,  5.28s/it]Running generate_until requests:  28%|██▊       | 47/165 [05:02<09:41,  4.93s/it]Running generate_until requests:  29%|██▉       | 48/165 [05:06<09:16,  4.75s/it]Running generate_until requests:  30%|██▉       | 49/165 [05:08<07:28,  3.87s/it]Running generate_until requests:  30%|███       | 50/165 [05:13<08:20,  4.36s/it]Running generate_until requests:  31%|███       | 51/165 [05:18<08:40,  4.57s/it]Running generate_until requests:  32%|███▏      | 52/165 [05:22<08:18,  4.41s/it]Running generate_until requests:  32%|███▏      | 53/165 [05:32<11:19,  6.07s/it]Running generate_until requests:  33%|███▎      | 54/165 [05:40<12:09,  6.58s/it]Running generate_until requests:  33%|███▎      | 55/165 [05:45<11:20,  6.19s/it]Running generate_until requests:  34%|███▍      | 56/165 [05:51<10:57,  6.04s/it]Running generate_until requests:  35%|███▍      | 57/165 [05:56<10:04,  5.60s/it]Running generate_until requests:  35%|███▌      | 58/165 [06:07<13:13,  7.42s/it]Running generate_until requests:  36%|███▌      | 59/165 [06:12<11:42,  6.63s/it]Running generate_until requests:  36%|███▋      | 60/165 [06:16<10:25,  5.96s/it]Running generate_until requests:  37%|███▋      | 61/165 [06:22<09:56,  5.74s/it]Running generate_until requests:  38%|███▊      | 62/165 [06:25<08:39,  5.05s/it]Running generate_until requests:  38%|███▊      | 63/165 [06:31<08:56,  5.26s/it]Running generate_until requests:  39%|███▉      | 64/165 [06:34<07:54,  4.70s/it]Running generate_until requests:  39%|███▉      | 65/165 [06:37<06:45,  4.06s/it]Running generate_until requests:  40%|████      | 66/165 [06:44<08:10,  4.96s/it]Running generate_until requests:  41%|████      | 67/165 [06:46<06:40,  4.09s/it]Running generate_until requests:  41%|████      | 68/165 [06:51<07:16,  4.50s/it]Running generate_until requests:  42%|████▏     | 69/165 [06:57<07:33,  4.72s/it]Running generate_until requests:  42%|████▏     | 70/165 [07:08<10:49,  6.84s/it]Running generate_until requests:  43%|████▎     | 71/165 [07:18<11:46,  7.51s/it]Running generate_until requests:  44%|████▎     | 72/165 [07:26<11:54,  7.68s/it]Running generate_until requests:  44%|████▍     | 73/165 [07:32<11:00,  7.17s/it]Running generate_until requests:  45%|████▍     | 74/165 [07:36<09:37,  6.34s/it]Running generate_until requests:  45%|████▌     | 75/165 [07:48<11:58,  7.99s/it]Running generate_until requests:  46%|████▌     | 76/165 [07:55<11:33,  7.80s/it]Running generate_until requests:  47%|████▋     | 77/165 [08:07<13:12,  9.00s/it]Running generate_until requests:  47%|████▋     | 78/165 [08:16<12:51,  8.87s/it]Running generate_until requests:  48%|████▊     | 79/165 [08:21<11:17,  7.88s/it]Running generate_until requests:  48%|████▊     | 80/165 [08:33<12:49,  9.05s/it]Running generate_until requests:  49%|████▉     | 81/165 [08:37<10:39,  7.62s/it]Running generate_until requests:  50%|████▉     | 82/165 [08:41<08:49,  6.39s/it]Running generate_until requests:  50%|█████     | 83/165 [08:49<09:40,  7.08s/it]Running generate_until requests:  51%|█████     | 84/165 [08:54<08:40,  6.43s/it]Running generate_until requests:  52%|█████▏    | 85/165 [09:02<09:01,  6.77s/it]Running generate_until requests:  52%|█████▏    | 86/165 [09:09<09:06,  6.91s/it]Running generate_until requests:  53%|█████▎    | 87/165 [09:14<08:15,  6.35s/it]Running generate_until requests:  53%|█████▎    | 88/165 [09:18<07:09,  5.58s/it]Running generate_until requests:  54%|█████▍    | 89/165 [09:22<06:31,  5.15s/it]Running generate_until requests:  55%|█████▍    | 90/165 [09:25<05:32,  4.44s/it]Running generate_until requests:  55%|█████▌    | 91/165 [09:29<05:30,  4.47s/it]Running generate_until requests:  56%|█████▌    | 92/165 [09:33<05:03,  4.16s/it]Running generate_until requests:  56%|█████▋    | 93/165 [09:37<04:57,  4.13s/it]Running generate_until requests:  57%|█████▋    | 94/165 [09:42<05:11,  4.38s/it]Running generate_until requests:  58%|█████▊    | 95/165 [09:48<05:48,  4.98s/it]Running generate_until requests:  58%|█████▊    | 96/165 [09:53<05:31,  4.81s/it]Running generate_until requests:  59%|█████▉    | 97/165 [09:59<05:53,  5.20s/it]Running generate_until requests:  59%|█████▉    | 98/165 [10:04<05:46,  5.17s/it]Running generate_until requests:  60%|██████    | 99/165 [10:12<06:38,  6.03s/it]Running generate_until requests:  61%|██████    | 100/165 [10:16<05:59,  5.54s/it]Running generate_until requests:  61%|██████    | 101/165 [10:22<06:03,  5.68s/it]Running generate_until requests:  62%|██████▏   | 102/165 [10:27<05:46,  5.51s/it]Running generate_until requests:  62%|██████▏   | 103/165 [10:29<04:30,  4.36s/it]Running generate_until requests:  63%|██████▎   | 104/165 [10:31<03:47,  3.73s/it]Running generate_until requests:  64%|██████▎   | 105/165 [10:36<03:58,  3.97s/it]Running generate_until requests:  64%|██████▍   | 106/165 [10:39<03:39,  3.72s/it]Running generate_until requests:  65%|██████▍   | 107/165 [10:43<03:47,  3.93s/it]Running generate_until requests:  65%|██████▌   | 108/165 [10:47<03:42,  3.90s/it]Running generate_until requests:  66%|██████▌   | 109/165 [10:52<03:44,  4.01s/it]Running generate_until requests:  67%|██████▋   | 110/165 [11:03<05:47,  6.32s/it]Running generate_until requests:  67%|██████▋   | 111/165 [11:09<05:38,  6.26s/it]Running generate_until requests:  68%|██████▊   | 112/165 [11:13<04:48,  5.45s/it]Running generate_until requests:  68%|██████▊   | 113/165 [11:17<04:23,  5.06s/it]Running generate_until requests:  69%|██████▉   | 114/165 [11:23<04:30,  5.30s/it]Running generate_until requests:  70%|██████▉   | 115/165 [11:26<03:50,  4.61s/it]Running generate_until requests:  70%|███████   | 116/165 [11:29<03:17,  4.03s/it]Running generate_until requests:  71%|███████   | 117/165 [11:30<02:42,  3.39s/it]Running generate_until requests:  72%|███████▏  | 118/165 [11:34<02:40,  3.42s/it]Running generate_until requests:  72%|███████▏  | 119/165 [11:38<02:45,  3.61s/it]Running generate_until requests:  73%|███████▎  | 120/165 [11:43<02:58,  3.97s/it]Running generate_until requests:  73%|███████▎  | 121/165 [11:45<02:33,  3.49s/it]Running generate_until requests:  74%|███████▍  | 122/165 [11:52<03:08,  4.38s/it]Running generate_until requests:  75%|███████▍  | 123/165 [11:59<03:39,  5.22s/it]Running generate_until requests:  75%|███████▌  | 124/165 [12:04<03:34,  5.24s/it]Running generate_until requests:  76%|███████▌  | 125/165 [12:16<04:48,  7.20s/it]Running generate_until requests:  76%|███████▋  | 126/165 [12:21<04:18,  6.63s/it]Running generate_until requests:  77%|███████▋  | 127/165 [12:27<03:59,  6.31s/it]Running generate_until requests:  78%|███████▊  | 128/165 [12:39<04:54,  7.97s/it]Running generate_until requests:  78%|███████▊  | 129/165 [12:43<04:08,  6.90s/it]Running generate_until requests:  79%|███████▉  | 130/165 [12:50<04:00,  6.88s/it]Running generate_until requests:  79%|███████▉  | 131/165 [13:02<04:43,  8.35s/it]Running generate_until requests:  80%|████████  | 132/165 [13:06<03:53,  7.08s/it]Running generate_until requests:  81%|████████  | 133/165 [13:12<03:38,  6.83s/it]Running generate_until requests:  81%|████████  | 134/165 [13:24<04:18,  8.33s/it]Running generate_until requests:  82%|████████▏ | 135/165 [13:28<03:34,  7.16s/it]Running generate_until requests:  82%|████████▏ | 136/165 [13:32<02:56,  6.10s/it]Running generate_until requests:  83%|████████▎ | 137/165 [13:36<02:32,  5.46s/it]Running generate_until requests:  84%|████████▎ | 138/165 [13:41<02:25,  5.39s/it]Running generate_until requests:  84%|████████▍ | 139/165 [13:53<03:10,  7.31s/it]Running generate_until requests:  85%|████████▍ | 140/165 [13:57<02:42,  6.49s/it]Running generate_until requests:  85%|████████▌ | 141/165 [14:04<02:38,  6.58s/it]Running generate_until requests:  86%|████████▌ | 142/165 [14:08<02:09,  5.64s/it]Running generate_until requests:  87%|████████▋ | 143/165 [14:12<01:58,  5.37s/it]Running generate_until requests:  87%|████████▋ | 144/165 [14:17<01:49,  5.24s/it]Running generate_until requests:  88%|████████▊ | 145/165 [14:23<01:45,  5.28s/it]Running generate_until requests:  88%|████████▊ | 146/165 [14:28<01:42,  5.41s/it]Running generate_until requests:  89%|████████▉ | 147/165 [14:32<01:28,  4.92s/it]Running generate_until requests:  90%|████████▉ | 148/165 [14:38<01:30,  5.31s/it]Running generate_until requests:  90%|█████████ | 149/165 [14:41<01:11,  4.49s/it]Running generate_until requests:  91%|█████████ | 150/165 [14:45<01:03,  4.21s/it]Running generate_until requests:  92%|█████████▏| 151/165 [14:49<01:01,  4.37s/it]Running generate_until requests:  92%|█████████▏| 152/165 [14:54<00:57,  4.45s/it]Running generate_until requests:  93%|█████████▎| 153/165 [15:00<00:58,  4.84s/it]Running generate_until requests:  93%|█████████▎| 154/165 [15:04<00:52,  4.78s/it]Running generate_until requests:  94%|█████████▍| 155/165 [15:07<00:40,  4.02s/it]Running generate_until requests:  95%|█████████▍| 156/165 [15:13<00:41,  4.59s/it]Running generate_until requests:  95%|█████████▌| 157/165 [15:16<00:34,  4.31s/it]Running generate_until requests:  96%|█████████▌| 158/165 [15:28<00:45,  6.53s/it]Running generate_until requests:  96%|█████████▋| 159/165 [15:36<00:41,  6.99s/it]Running generate_until requests:  97%|█████████▋| 160/165 [15:41<00:31,  6.30s/it]Running generate_until requests:  98%|█████████▊| 161/165 [15:44<00:21,  5.38s/it]Running generate_until requests:  98%|█████████▊| 162/165 [15:49<00:15,  5.27s/it]Running generate_until requests:  99%|█████████▉| 163/165 [15:55<00:11,  5.51s/it]Running generate_until requests:  99%|█████████▉| 164/165 [15:57<00:04,  4.36s/it]Running generate_until requests: 100%|██████████| 165/165 [16:04<00:00,  5.18s/it]Running generate_until requests: 100%|██████████| 165/165 [16:04<00:00,  5.84s/it]
[2024-06-03 15:01:32,236] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 897134 closing signal SIGTERM
[2024-06-03 15:01:32,267] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 897135 closing signal SIGTERM
[2024-06-03 15:01:32,268] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 897136 closing signal SIGTERM
[2024-06-03 15:01:32,268] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 897137 closing signal SIGTERM
[2024-06-03 15:01:32,268] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 897138 closing signal SIGTERM
[2024-06-03 15:01:41,948] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: -7) local_rank: 7 (pid: 897141) of binary: /private/home/beidic/.conda/envs/griffin/bin/python
Traceback (most recent call last):
  File "/private/home/beidic/.conda/envs/griffin/bin/accelerate", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/private/home/beidic/.conda/envs/griffin/lib/python3.12/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/private/home/beidic/.conda/envs/griffin/lib/python3.12/site-packages/accelerate/commands/launch.py", line 985, in launch_command
    multi_gpu_launcher(args)
  File "/private/home/beidic/.conda/envs/griffin/lib/python3.12/site-packages/accelerate/commands/launch.py", line 654, in multi_gpu_launcher
    distrib_run.run(args)
  File "/private/home/beidic/.conda/envs/griffin/lib/python3.12/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/private/home/beidic/.conda/envs/griffin/lib/python3.12/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/private/home/beidic/.conda/envs/griffin/lib/python3.12/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
======================================================
main.py FAILED
------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-06-03_15:01:32
  host      : learnfair7456.h2.fair
  rank      : 7 (local_rank: 7)
  exitcode  : -7 (pid: 897141)
  error_file: <N/A>
  traceback : Signal 7 (SIGBUS) received by PID 897141
======================================================
/var/spool/slurm//job28548885/slurm_script: line 64: 897110 Bus error               (core dumped) accelerate launch --main_process_port 29510 --num_processes 8 --num_machines 1 main.py --model xhf --model_args pretrained=meta-llama/Llama-2-7b-hf,griffin=False,check=False --tasks gsm8k --batch_size 1
