Already up to date.
Obtaining file:///opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/transformersprofiling
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Checking if build backend supports build_editable: started
  Checking if build backend supports build_editable: finished with status 'done'
  Getting requirements to build editable: started
  Getting requirements to build editable: finished with status 'done'
  Installing backend dependencies: started
  Installing backend dependencies: finished with status 'done'
  Preparing editable metadata (pyproject.toml): started
  Preparing editable metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: filelock in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from transformers==4.36.0.dev0) (3.13.1)
Requirement already satisfied: huggingface-hub<1.0,>=0.19.3 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from transformers==4.36.0.dev0) (0.21.4)
Requirement already satisfied: numpy>=1.17 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from transformers==4.36.0.dev0) (1.26.4)
Requirement already satisfied: packaging>=20.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from transformers==4.36.0.dev0) (23.2)
Requirement already satisfied: pyyaml>=5.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from transformers==4.36.0.dev0) (6.0.1)
Requirement already satisfied: regex!=2019.12.17 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from transformers==4.36.0.dev0) (2023.12.25)
Requirement already satisfied: requests in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from transformers==4.36.0.dev0) (2.31.0)
Requirement already satisfied: tokenizers<0.19,>=0.14 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from transformers==4.36.0.dev0) (0.15.2)
Requirement already satisfied: safetensors>=0.3.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from transformers==4.36.0.dev0) (0.4.2)
Requirement already satisfied: tqdm>=4.27 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from transformers==4.36.0.dev0) (4.66.2)
Requirement already satisfied: fsspec>=2023.5.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from huggingface-hub<1.0,>=0.19.3->transformers==4.36.0.dev0) (2023.10.0)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from huggingface-hub<1.0,>=0.19.3->transformers==4.36.0.dev0) (4.9.0)
Requirement already satisfied: charset-normalizer<4,>=2 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests->transformers==4.36.0.dev0) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests->transformers==4.36.0.dev0) (3.6)
Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests->transformers==4.36.0.dev0) (1.26.18)
Requirement already satisfied: certifi>=2017.4.17 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests->transformers==4.36.0.dev0) (2024.2.2)
Building wheels for collected packages: transformers
  Building editable for transformers (pyproject.toml): started
  Building editable for transformers (pyproject.toml): finished with status 'done'
  Created wheel for transformers: filename=transformers-4.36.0.dev0-0.editable-py3-none-any.whl size=40509 sha256=ad25a1aa1b42d22fd8baddca6bafb2b18e8ba149ad0e45d17f02763d1b2cefab
  Stored in directory: /tmp/pip-ephem-wheel-cache-s99o14a3/wheels/b7/36/f7/419f9185aae64b34b34c9ec7bc0c4910b3433f825ab8b94ec7
Successfully built transformers
Installing collected packages: transformers
  Attempting uninstall: transformers
    Found existing installation: transformers 4.36.0.dev0
    Uninstalling transformers-4.36.0.dev0:
      Successfully uninstalled transformers-4.36.0.dev0
Successfully installed transformers-4.36.0.dev0
Requirement already satisfied: termcolor in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (2.4.0)
Requirement already satisfied: wandb in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (0.16.3)
Requirement already satisfied: Click!=8.0.0,>=7.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from wandb) (8.1.7)
Requirement already satisfied: GitPython!=3.1.29,>=1.0.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from wandb) (3.1.41)
Requirement already satisfied: requests<3,>=2.0.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from wandb) (2.31.0)
Requirement already satisfied: psutil>=5.0.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from wandb) (5.9.8)
Requirement already satisfied: sentry-sdk>=1.0.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from wandb) (1.40.4)
Requirement already satisfied: docker-pycreds>=0.4.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from wandb) (0.4.0)
Requirement already satisfied: PyYAML in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from wandb) (6.0.1)
Requirement already satisfied: setproctitle in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from wandb) (1.3.3)
Requirement already satisfied: setuptools in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from wandb) (69.0.3)
Requirement already satisfied: appdirs>=1.4.3 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from wandb) (1.4.4)
Requirement already satisfied: typing-extensions in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from wandb) (4.9.0)
Requirement already satisfied: protobuf!=4.21.0,<5,>=3.15.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from wandb) (4.25.2)
Requirement already satisfied: six>=1.4.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from docker-pycreds>=0.4.0->wandb) (1.16.0)
Requirement already satisfied: gitdb<5,>=4.0.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from GitPython!=3.1.29,>=1.0.0->wandb) (4.0.11)
Requirement already satisfied: charset-normalizer<4,>=2 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests<3,>=2.0.0->wandb) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests<3,>=2.0.0->wandb) (3.6)
Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests<3,>=2.0.0->wandb) (1.26.18)
Requirement already satisfied: certifi>=2017.4.17 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests<3,>=2.0.0->wandb) (2024.2.2)
Requirement already satisfied: smmap<6,>=3.0.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from gitdb<5,>=4.0.1->GitPython!=3.1.29,>=1.0.0->wandb) (5.0.1)
Requirement already satisfied: datasets in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (2.17.0)
Requirement already satisfied: filelock in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from datasets) (3.13.1)
Requirement already satisfied: numpy>=1.17 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from datasets) (1.26.4)
Requirement already satisfied: pyarrow>=12.0.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from datasets) (15.0.0)
Requirement already satisfied: pyarrow-hotfix in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from datasets) (0.6)
Requirement already satisfied: dill<0.3.9,>=0.3.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from datasets) (0.3.8)
Requirement already satisfied: pandas in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from datasets) (2.2.0)
Requirement already satisfied: requests>=2.19.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from datasets) (2.31.0)
Requirement already satisfied: tqdm>=4.62.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from datasets) (4.66.2)
Requirement already satisfied: xxhash in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from datasets) (3.4.1)
Requirement already satisfied: multiprocess in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from datasets) (0.70.16)
Requirement already satisfied: fsspec<=2023.10.0,>=2023.1.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from fsspec[http]<=2023.10.0,>=2023.1.0->datasets) (2023.10.0)
Requirement already satisfied: aiohttp in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from datasets) (3.9.3)
Requirement already satisfied: huggingface-hub>=0.19.4 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from datasets) (0.21.4)
Requirement already satisfied: packaging in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from datasets) (23.2)
Requirement already satisfied: pyyaml>=5.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from datasets) (6.0.1)
Requirement already satisfied: aiosignal>=1.1.2 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from aiohttp->datasets) (1.3.1)
Requirement already satisfied: attrs>=17.3.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from aiohttp->datasets) (23.2.0)
Requirement already satisfied: frozenlist>=1.1.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from aiohttp->datasets) (1.4.1)
Requirement already satisfied: multidict<7.0,>=4.5 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from aiohttp->datasets) (6.0.5)
Requirement already satisfied: yarl<2.0,>=1.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from aiohttp->datasets) (1.9.4)
Requirement already satisfied: async-timeout<5.0,>=4.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from aiohttp->datasets) (4.0.3)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from huggingface-hub>=0.19.4->datasets) (4.9.0)
Requirement already satisfied: charset-normalizer<4,>=2 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests>=2.19.0->datasets) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests>=2.19.0->datasets) (3.6)
Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests>=2.19.0->datasets) (1.26.18)
Requirement already satisfied: certifi>=2017.4.17 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests>=2.19.0->datasets) (2024.2.2)
Requirement already satisfied: python-dateutil>=2.8.2 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from pandas->datasets) (2.8.2)
Requirement already satisfied: pytz>=2020.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from pandas->datasets) (2024.1)
Requirement already satisfied: tzdata>=2022.7 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from pandas->datasets) (2024.1)
Requirement already satisfied: six>=1.5 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from python-dateutil>=2.8.2->pandas->datasets) (1.16.0)
Requirement already satisfied: accelerate in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (0.27.0)
Requirement already satisfied: numpy>=1.17 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from accelerate) (1.26.4)
Requirement already satisfied: packaging>=20.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from accelerate) (23.2)
Requirement already satisfied: psutil in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from accelerate) (5.9.8)
Requirement already satisfied: pyyaml in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from accelerate) (6.0.1)
Requirement already satisfied: torch>=1.10.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from accelerate) (2.1.0)
Requirement already satisfied: huggingface-hub in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from accelerate) (0.21.4)
Requirement already satisfied: safetensors>=0.3.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from accelerate) (0.4.2)
Requirement already satisfied: filelock in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (3.13.1)
Requirement already satisfied: typing-extensions in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (4.9.0)
Requirement already satisfied: sympy in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (1.12)
Requirement already satisfied: networkx in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (3.2.1)
Requirement already satisfied: jinja2 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (3.1.3)
Requirement already satisfied: fsspec in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (2023.10.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==8.9.2.26 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (8.9.2.26)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.18.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (2.18.1)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (12.1.105)
Requirement already satisfied: triton==2.1.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from torch>=1.10.0->accelerate) (2.1.0)
Requirement already satisfied: nvidia-nvjitlink-cu12 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch>=1.10.0->accelerate) (12.3.101)
Requirement already satisfied: requests in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from huggingface-hub->accelerate) (2.31.0)
Requirement already satisfied: tqdm>=4.42.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from huggingface-hub->accelerate) (4.66.2)
Requirement already satisfied: MarkupSafe>=2.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from jinja2->torch>=1.10.0->accelerate) (2.1.5)
Requirement already satisfied: charset-normalizer<4,>=2 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests->huggingface-hub->accelerate) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests->huggingface-hub->accelerate) (3.6)
Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests->huggingface-hub->accelerate) (1.26.18)
Requirement already satisfied: certifi>=2017.4.17 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests->huggingface-hub->accelerate) (2024.2.2)
Requirement already satisfied: mpmath>=0.19 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from sympy->torch>=1.10.0->accelerate) (1.3.0)
Requirement already satisfied: huggingface_hub[cli] in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (0.21.4)
Requirement already satisfied: filelock in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from huggingface_hub[cli]) (3.13.1)
Requirement already satisfied: fsspec>=2023.5.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from huggingface_hub[cli]) (2023.10.0)
Requirement already satisfied: requests in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from huggingface_hub[cli]) (2.31.0)
Requirement already satisfied: tqdm>=4.42.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from huggingface_hub[cli]) (4.66.2)
Requirement already satisfied: pyyaml>=5.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from huggingface_hub[cli]) (6.0.1)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from huggingface_hub[cli]) (4.9.0)
Requirement already satisfied: packaging>=20.9 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from huggingface_hub[cli]) (23.2)
Requirement already satisfied: InquirerPy==0.3.4 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from huggingface_hub[cli]) (0.3.4)
Requirement already satisfied: pfzy<0.4.0,>=0.3.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from InquirerPy==0.3.4->huggingface_hub[cli]) (0.3.4)
Requirement already satisfied: prompt-toolkit<4.0.0,>=3.0.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from InquirerPy==0.3.4->huggingface_hub[cli]) (3.0.43)
Requirement already satisfied: charset-normalizer<4,>=2 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests->huggingface_hub[cli]) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests->huggingface_hub[cli]) (3.6)
Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests->huggingface_hub[cli]) (1.26.18)
Requirement already satisfied: certifi>=2017.4.17 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from requests->huggingface_hub[cli]) (2024.2.2)
Requirement already satisfied: wcwidth in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from prompt-toolkit<4.0.0,>=3.0.1->InquirerPy==0.3.4->huggingface_hub[cli]) (0.2.13)
Requirement already satisfied: matplotlib in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (3.8.3)
Requirement already satisfied: contourpy>=1.0.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from matplotlib) (1.2.0)
Requirement already satisfied: cycler>=0.10 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from matplotlib) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from matplotlib) (4.49.0)
Requirement already satisfied: kiwisolver>=1.3.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from matplotlib) (1.4.5)
Requirement already satisfied: numpy<2,>=1.21 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from matplotlib) (1.26.4)
Requirement already satisfied: packaging>=20.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from matplotlib) (23.2)
Requirement already satisfied: pillow>=8 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from matplotlib) (9.4.0)
Requirement already satisfied: pyparsing>=2.3.1 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from matplotlib) (3.1.1)
Requirement already satisfied: python-dateutil>=2.7 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from matplotlib) (2.8.2)
Requirement already satisfied: importlib-resources>=3.2.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from matplotlib) (6.1.2)
Requirement already satisfied: zipp>=3.1.0 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from importlib-resources>=3.2.0->matplotlib) (3.17.0)
Requirement already satisfied: six>=1.5 in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (from python-dateutil>=2.7->matplotlib) (1.16.0)
Requirement already satisfied: sentencepiece in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages (0.1.99)
/data/home/beidic/anaconda3/envs/yangllm2/bin/python
/data/home/beidic/anaconda3/envs/yangllm2/bin/python
[1m[31mERROR! `huggingface-cli login` uses an outdated login mechanism that is not compatible with the Hugging Face Hub backend anymore. Please use `huggingface-cli login instead.[0m
Token has not been saved to git credential helper. Pass `add_to_git_credential=True` if you want to set the git credential as well.
Token is valid (permission: read).
Your token has been saved to /data/home/beidic/.cache/huggingface/token
Login successful
the commit hash is a51645a
the hash of time is 260196
Hostname: a100-st-p4de24xlarge-1026
the commit hash is a51645a
the hash of time is 260704
Hostname: a100-st-p4de24xlarge-1026
the commit hash is a51645a
the hash of time is 261970
Namespace(group1lr=0.0002, group2lr=0.002, experiment_setting='setting0', eval_mode=False, embedding_pretrained=False, kernel_size=7, use_plain_model=True, model_name='tinyllama', resume_from_checkpoint=None, past_token_centric=False, debug=False)Hostname:
 a100-st-p4de24xlarge-1026
Namespace(group1lr=0.0002, group2lr=0.002, experiment_setting='setting0', eval_mode=False, embedding_pretrained=False, kernel_size=7, use_plain_model=True, model_name='tinyllama', resume_from_checkpoint=None, past_token_centric=False, debug=False)
the commit hash is a51645a
the hash of time is 263344
Hostname: a100-st-p4de24xlarge-1026
the commit hash is a51645a
Namespace(group1lr=0.0002, group2lr=0.002, experiment_setting='setting0', eval_mode=False, embedding_pretrained=False, kernel_size=7, use_plain_model=True, model_name='tinyllama', resume_from_checkpoint=None, past_token_centric=False, debug=False)
the hash of time is 264249
Hostname: a100-st-p4de24xlarge-1026
Namespace(group1lr=0.0002, group2lr=0.002, experiment_setting='setting0', eval_mode=False, embedding_pretrained=False, kernel_size=7, use_plain_model=True, model_name='tinyllama', resume_from_checkpoint=None, past_token_centric=False, debug=False)
Namespace(group1lr=0.0002, group2lr=0.002, experiment_setting='setting0', eval_mode=False, embedding_pretrained=False, kernel_size=7, use_plain_model=True, model_name='tinyllama', resume_from_checkpoint=None, past_token_centric=False, debug=False)
the commit hash is a51645a
the hash of time is 274346
Hostname: a100-st-p4de24xlarge-1026
Namespace(group1lr=0.0002, group2lr=0.002, experiment_setting='setting0', eval_mode=False, embedding_pretrained=False, kernel_size=7, use_plain_model=True, model_name='tinyllama', resume_from_checkpoint=None, past_token_centric=False, debug=False)
the commit hash is a51645a
the hash of time is 283459
Hostname: a100-st-p4de24xlarge-1026
Namespace(group1lr=0.0002, group2lr=0.002, experiment_setting='setting0', eval_mode=False, embedding_pretrained=False, kernel_size=7, use_plain_model=True, model_name='tinyllama', resume_from_checkpoint=None, past_token_centric=False, debug=False)
the commit hash is a51645a
the hash of time is 297036
Hostname: a100-st-p4de24xlarge-1026
Namespace(group1lr=0.0002, group2lr=0.002, experiment_setting='setting0', eval_mode=False, embedding_pretrained=False, kernel_size=7, use_plain_model=True, model_name='tinyllama', resume_from_checkpoint=None, past_token_centric=False, debug=False)
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
we use plain model
we use plain model
we use plain model
we use plain model
we use plain model
we use plain model
we use plain model
we use plain model
76 0
76 0
76 0
76 0
76 0
76 0
resum_from_checkpoint is None
torch.float32
76 0
76 0
resum_from_checkpoint is None
torch.float32
resum_from_checkpoint is None
torch.float32
resum_from_checkpoint is None
torch.float32
experiment-setting is setting0
resume from checkpoint: None
resume_from_checkpoint is None
resum_from_checkpoint is None
torch.float32
experiment-setting is setting0
resume from checkpoint: None
resume_from_checkpoint is None
resum_from_checkpoint is None
torch.float32
resum_from_checkpoint is None
torch.float32
resum_from_checkpoint is None
torch.float32
experiment-setting is setting0
resume from checkpoint: None
resume_from_checkpoint is None
experiment-setting is setting0
resume from checkpoint: None
resume_from_checkpoint is None
experiment-setting is setting0
resume from checkpoint: None
resume_from_checkpoint is None
experiment-setting is setting0
resume from checkpoint: None
resume_from_checkpoint is None
experiment-setting is setting0
resume from checkpoint: None
resume_from_checkpoint is None
experiment-setting is setting0
resume from checkpoint: None
resume_from_checkpoint is None
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
inside the labels
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
inside the labels
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
rank 3 and the loss is 3.2329773902893066rank 7 and the loss is 3.2991929054260254rank 5 and the loss is 3.059015989303589rank 2 and the loss is 3.354682207107544rank 6 and the loss is 3.175025701522827rank 4 and the loss is 3.4286115169525146
rank 1 and the loss is 3.1367604732513428

rank 0 and the loss is 3.2816898822784424




generating images ... at iteration 0
the training iteration count is 1
the training iteration count is 1
the training iteration count is 1
the training iteration count is 1
the training iteration count is 1
the training iteration count is 1
the training iteration count is 1
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
inside the labels
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
inside the labels
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
rank 5 and the loss is 3.1811459064483643
rank 7 and the loss is 3.376640796661377
rank 1 and the loss is 3.4187610149383545
rank 2 and the loss is 3.3472366333007812
rank 3 and the loss is 3.2555811405181885
rank 4 and the loss is 3.287597894668579
rank 6 and the loss is 3.372551202774048
the training iteration count is 2
the training iteration count is 2
the training iteration count is 2
the training iteration count is 2
the training iteration count is 2
the training iteration count is 2
the training iteration count is 2
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
rank 7 and the loss is 3.585587739944458
rank 4 and the loss is 3.268864870071411
rank 6 and the loss is 3.3315422534942627
rank 3 and the loss is 3.428619384765625
rank 2 and the loss is 3.317357301712036
rank 5 and the loss is 3.456052541732788
rank 1 and the loss is 3.311613082885742
the training iteration count is 3
the training iteration count is 3
the training iteration count is 3
the training iteration count is 3
the training iteration count is 3
the training iteration count is 3
the training iteration count is 3
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
<class 'list'>
<class 'dict'>
inside the data collator
input_ids
attention_mask
inside the labels
type of the model is <class 'torch.nn.parallel.distributed.DistributedDataParallel'>
rank 7 and the loss is 3.1110565662384033
rank 3 and the loss is 3.4223849773406982
rank 4 and the loss is 3.649275302886963
rank 2 and the loss is 3.370060682296753
rank 5 and the loss is 2.9871318340301514
rank 1 and the loss is 3.2648472785949707
rank 6 and the loss is 3.2889955043792725
the training iteration count is 4
the training iteration count is 4
the training iteration count is 4the training iteration count is 4

the training iteration count is 4
the training iteration count is 4
the training iteration count is 4
