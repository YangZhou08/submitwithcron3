wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:50<00:50, 50.68s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:57<00:57, 57.76s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.29s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.35s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.50s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.33s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:24<00:24, 24.13s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:23<00:23, 23.88s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:01<00:00, 26.01s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:01<00:00, 30.88s/it]
Some weights of LlamaWeirdLargeTest were not initialized from the model checkpoint at meta-llama/Llama-2-7b-hf and are newly initialized: ['addonsmallmodel.layers.3.mlp.gate_proj.weight', 'addonsmallmodel.layers.0.self_attn.v_proj.weight', 'addonsmallmodel.layers.10.self_attn.k_proj.weight', 'addonsmallmodel.layers.2.mlp.down_proj.weight', 'addonsmallmodel.layers.1.self_attn.k_proj.weight', 'addonsmallmodel.layers.4.self_attn.o_proj.weight', 'addonsmallmodel.layers.7.mlp.up_proj.weight', 'addonsmallmodel.layers.3.self_attn.o_proj.weight', 'addonsmallmodel.layers.7.self_attn.o_proj.weight', 'addonsmallmodel.layers.7.self_attn.k_proj.weight', 'addonsmallmodel.layers.3.input_layernorm.weight', 'addonsmallmodel.layers.11.self_attn.v_proj.weight', 'addonsmallmodel.layers.1.self_attn.o_proj.weight', 'addonsmallmodel.layers.0.self_attn.k_proj.weight', 'addonsmallmodel.layers.0.mlp.down_proj.weight', 'addonsmallmodel.layers.8.mlp.gate_proj.weight', 'addonsmallmodel.layers.9.mlp.up_proj.weight', 'addonsmallmodel.layers.6.self_attn.q_proj.weight', 'addonsmallmodel.layers.9.post_attention_layernorm.weight', 'addonsmallmodel.layers.8.self_attn.q_proj.weight', 'addonsmallmodel.layers.4.post_attention_layernorm.weight', 'addonsmallmodel.layers.11.mlp.gate_proj.weight', 'addonsmallmodel.layers.3.mlp.up_proj.weight', 'addonsmallmodel.layers.2.mlp.up_proj.weight', 'addonsmallmodel.layers.4.mlp.up_proj.weight', 'addonsmallmodel.layers.5.mlp.gate_proj.weight', 'addonsmallmodel.layers.3.post_attention_layernorm.weight', 'addonsmallmodel.embed_tokens.weight', 'addonsmallmodel.layers.2.post_attention_layernorm.weight', 'addonsmallmodel.layers.9.mlp.down_proj.weight', 'addonsmallmodel.layers.0.input_layernorm.weight', 'addonsmallmodel.layers.2.mlp.gate_proj.weight', 'addonsmallmodel.layers.4.input_layernorm.weight', 'addonsmallmodel.layers.5.post_attention_layernorm.weight', 'addonsmallmodel.layers.0.mlp.up_proj.weight', 'addonsmallmodel.layers.9.self_attn.k_proj.weight', 'addonsmallmodel.layers.1.self_attn.q_proj.weight', 'addonsmallmodel.lm_head.weight', 'addonsmallmodel.layers.2.self_attn.o_proj.weight', 'addonsmallmodel.layers.5.self_attn.o_proj.weight', 'addonsmallmodel.layers.10.self_attn.v_proj.weight', 'addonsmallmodel.layers.0.self_attn.o_proj.weight', 'addonsmallmodel.layers.3.self_attn.v_proj.weight', 'addonsmallmodel.layers.9.self_attn.o_proj.weight', 'addonsmallmodel.layers.7.self_attn.v_proj.weight', 'addonsmallmodel.layers.4.self_attn.q_proj.weight', 'addonsmallmodel.layers.5.mlp.up_proj.weight', 'addonsmallmodel.layers.1.post_attention_layernorm.weight', 'addonsmallmodel.layers.6.mlp.gate_proj.weight', 'addonsmallmodel.layers.1.self_attn.v_proj.weight', 'addonsmallmodel.layers.7.mlp.down_proj.weight', 'addonsmallmodel.layers.10.self_attn.q_proj.weight', 'addonsmallmodel.layers.10.mlp.down_proj.weight', 'addonsmallmodel.layers.6.post_attention_layernorm.weight', 'addonsmallmodel.layers.8.mlp.up_proj.weight', 'addonsmallmodel.layers.5.mlp.down_proj.weight', 'addonsmallmodel.embed_projection.weight', 'addonsmallmodel.layers.8.self_attn.o_proj.weight', 'addonsmallmodel.layers.3.self_attn.k_proj.weight', 'addonsmallmodel.layers.11.input_layernorm.weight', 'addonsmallmodel.layers.9.self_attn.q_proj.weight', 'addonsmallmodel.layers.0.mlp.gate_proj.weight', 'addonsmallmodel.layers.8.input_layernorm.weight', 'addonsmallmodel.layers.8.mlp.down_proj.weight', 'addonsmallmodel.layers.7.self_attn.q_proj.weight', 'addonsmallmodel.layers.5.self_attn.q_proj.weight', 'addonsmallmodel.layers.0.post_attention_layernorm.weight', 'addonsmallmodel.layers.8.post_attention_layernorm.weight', 'addonsmallmodel.layers.10.post_attention_layernorm.weight', 'addonsmallmodel.layers.1.input_layernorm.weight', 'addonsmallmodel.layers.6.input_layernorm.weight', 'addonsmallmodel.layers.9.mlp.gate_proj.weight', 'addonsmallmodel.layers.9.self_attn.v_proj.weight', 'addonsmallmodel.layers.7.post_attention_layernorm.weight', 'addonsmallmodel.layers.9.input_layernorm.weight', 'addonsmallmodel.layers.5.input_layernorm.weight', 'addonsmallmodel.layers.2.self_attn.v_proj.weight', 'addonsmallmodel.layers.11.post_attention_layernorm.weight', 'addonsmallmodel.layers.4.self_attn.v_proj.weight', 'addonsmallmodel.layers.7.mlp.gate_proj.weight', 'addonsmallmodel.layers.4.self_attn.k_proj.weight', 'addonsmallmodel.layers.11.self_attn.o_proj.weight', 'addonsmallmodel.layers.1.mlp.down_proj.weight', 'addonsmallmodel.layers.3.mlp.down_proj.weight', 'addonsmallmodel.layers.0.self_attn.q_proj.weight', 'addonsmallmodel.layers.10.input_layernorm.weight', 'addonsmallmodel.layers.5.self_attn.k_proj.weight', 'addonsmallmodel.layers.10.mlp.up_proj.weight', 'addonsmallmodel.layers.6.mlp.up_proj.weight', 'addonsmallmodel.layers.11.self_attn.q_proj.weight', 'addonsmallmodel.layers.2.self_attn.q_proj.weight', 'addonsmallmodel.norm.weight', 'addonsmallmodel.layers.5.self_attn.v_proj.weight', 'addonsmallmodel.layers.1.mlp.up_proj.weight', 'addonsmallmodel.layers.6.self_attn.k_proj.weight', 'addonsmallmodel.layers.10.mlp.gate_proj.weight', 'addonsmallmodel.layers.3.self_attn.q_proj.weight', 'addonsmallmodel.layers.6.self_attn.v_proj.weight', 'addonsmallmodel.layers.7.input_layernorm.weight', 'addonsmallmodel.layers.11.self_attn.k_proj.weight', 'addonsmallmodel.layers.6.self_attn.o_proj.weight', 'addonsmallmodel.layers.4.mlp.down_proj.weight', 'addonsmallmodel.layers.8.self_attn.k_proj.weight', 'addonsmallmodel.layers.1.mlp.gate_proj.weight', 'addonsmallmodel.layers.4.mlp.gate_proj.weight', 'addonsmallmodel.layers.11.mlp.down_proj.weight', 'addonsmallmodel.layers.10.self_attn.o_proj.weight', 'addonsmallmodel.layers.6.mlp.down_proj.weight', 'addonsmallmodel.layers.2.input_layernorm.weight', 'addonsmallmodel.layers.2.self_attn.k_proj.weight', 'addonsmallmodel.layers.11.mlp.up_proj.weight', 'addonsmallmodel.layers.8.self_attn.v_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Loading checkpoint shards: 100%|██████████| 2/2 [01:01<00:00, 25.98s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:01<00:00, 30.75s/it]
Some weights of LlamaWeirdLargeTest were not initialized from the model checkpoint at meta-llama/Llama-2-7b-hf and are newly initialized: ['addonsmallmodel.layers.3.post_attention_layernorm.weight', 'addonsmallmodel.layers.11.mlp.down_proj.weight', 'addonsmallmodel.layers.6.self_attn.o_proj.weight', 'addonsmallmodel.layers.4.self_attn.k_proj.weight', 'addonsmallmodel.layers.7.self_attn.q_proj.weight', 'addonsmallmodel.layers.10.self_attn.k_proj.weight', 'addonsmallmodel.layers.5.mlp.gate_proj.weight', 'addonsmallmodel.layers.0.mlp.up_proj.weight', 'addonsmallmodel.layers.4.input_layernorm.weight', 'addonsmallmodel.layers.11.self_attn.k_proj.weight', 'addonsmallmodel.layers.5.self_attn.k_proj.weight', 'addonsmallmodel.layers.2.self_attn.v_proj.weight', 'addonsmallmodel.layers.8.post_attention_layernorm.weight', 'addonsmallmodel.layers.8.mlp.gate_proj.weight', 'addonsmallmodel.layers.5.input_layernorm.weight', 'addonsmallmodel.layers.2.input_layernorm.weight', 'addonsmallmodel.layers.6.mlp.up_proj.weight', 'addonsmallmodel.layers.4.self_attn.q_proj.weight', 'addonsmallmodel.layers.8.self_attn.q_proj.weight', 'addonsmallmodel.layers.7.input_layernorm.weight', 'addonsmallmodel.layers.3.mlp.up_proj.weight', 'addonsmallmodel.layers.7.mlp.gate_proj.weight', 'addonsmallmodel.layers.5.self_attn.o_proj.weight', 'addonsmallmodel.layers.2.self_attn.k_proj.weight', 'addonsmallmodel.layers.1.post_attention_layernorm.weight', 'addonsmallmodel.layers.0.self_attn.q_proj.weight', 'addonsmallmodel.layers.1.input_layernorm.weight', 'addonsmallmodel.layers.10.post_attention_layernorm.weight', 'addonsmallmodel.layers.6.self_attn.v_proj.weight', 'addonsmallmodel.layers.1.self_attn.o_proj.weight', 'addonsmallmodel.layers.5.post_attention_layernorm.weight', 'addonsmallmodel.layers.10.mlp.gate_proj.weight', 'addonsmallmodel.layers.1.mlp.down_proj.weight', 'addonsmallmodel.layers.7.mlp.up_proj.weight', 'addonsmallmodel.layers.10.mlp.down_proj.weight', 'addonsmallmodel.layers.4.self_attn.o_proj.weight', 'addonsmallmodel.layers.9.mlp.gate_proj.weight', 'addonsmallmodel.layers.5.mlp.up_proj.weight', 'addonsmallmodel.layers.4.mlp.up_proj.weight', 'addonsmallmodel.layers.0.self_attn.v_proj.weight', 'addonsmallmodel.layers.1.mlp.gate_proj.weight', 'addonsmallmodel.layers.6.input_layernorm.weight', 'addonsmallmodel.layers.9.post_attention_layernorm.weight', 'addonsmallmodel.layers.0.post_attention_layernorm.weight', 'addonsmallmodel.layers.11.post_attention_layernorm.weight', 'addonsmallmodel.layers.6.self_attn.q_proj.weight', 'addonsmallmodel.layers.0.self_attn.k_proj.weight', 'addonsmallmodel.layers.7.mlp.down_proj.weight', 'addonsmallmodel.layers.10.self_attn.v_proj.weight', 'addonsmallmodel.layers.9.mlp.up_proj.weight', 'addonsmallmodel.layers.7.post_attention_layernorm.weight', 'addonsmallmodel.layers.1.self_attn.q_proj.weight', 'addonsmallmodel.layers.7.self_attn.k_proj.weight', 'addonsmallmodel.layers.6.post_attention_layernorm.weight', 'addonsmallmodel.embed_tokens.weight', 'addonsmallmodel.layers.4.post_attention_layernorm.weight', 'addonsmallmodel.layers.9.self_attn.q_proj.weight', 'addonsmallmodel.layers.6.self_attn.k_proj.weight', 'addonsmallmodel.layers.0.self_attn.o_proj.weight', 'addonsmallmodel.layers.4.self_attn.v_proj.weight', 'addonsmallmodel.layers.8.mlp.down_proj.weight', 'addonsmallmodel.embed_projection.weight', 'addonsmallmodel.layers.5.mlp.down_proj.weight', 'addonsmallmodel.layers.10.self_attn.o_proj.weight', 'addonsmallmodel.layers.11.self_attn.v_proj.weight', 'addonsmallmodel.layers.5.self_attn.v_proj.weight', 'addonsmallmodel.layers.2.self_attn.o_proj.weight', 'addonsmallmodel.layers.10.input_layernorm.weight', 'addonsmallmodel.layers.0.mlp.down_proj.weight', 'addonsmallmodel.layers.9.self_attn.o_proj.weight', 'addonsmallmodel.layers.8.input_layernorm.weight', 'addonsmallmodel.layers.5.self_attn.q_proj.weight', 'addonsmallmodel.layers.11.self_attn.o_proj.weight', 'addonsmallmodel.layers.3.mlp.gate_proj.weight', 'addonsmallmodel.layers.1.self_attn.v_proj.weight', 'addonsmallmodel.layers.10.mlp.up_proj.weight', 'addonsmallmodel.layers.9.mlp.down_proj.weight', 'addonsmallmodel.layers.6.mlp.down_proj.weight', 'addonsmallmodel.layers.4.mlp.down_proj.weight', 'addonsmallmodel.layers.8.self_attn.v_proj.weight', 'addonsmallmodel.layers.3.self_attn.q_proj.weight', 'addonsmallmodel.layers.2.post_attention_layernorm.weight', 'addonsmallmodel.layers.2.mlp.up_proj.weight', 'addonsmallmodel.layers.3.input_layernorm.weight', 'addonsmallmodel.layers.7.self_attn.o_proj.weight', 'addonsmallmodel.layers.7.self_attn.v_proj.weight', 'addonsmallmodel.layers.11.input_layernorm.weight', 'addonsmallmodel.layers.10.self_attn.q_proj.weight', 'addonsmallmodel.layers.11.self_attn.q_proj.weight', 'addonsmallmodel.layers.3.self_attn.v_proj.weight', 'addonsmallmodel.layers.11.mlp.gate_proj.weight', 'addonsmallmodel.layers.4.mlp.gate_proj.weight', 'addonsmallmodel.lm_head.weight', 'addonsmallmodel.layers.2.self_attn.q_proj.weight', 'addonsmallmodel.layers.9.self_attn.k_proj.weight', 'addonsmallmodel.layers.11.mlp.up_proj.weight', 'addonsmallmodel.layers.2.mlp.gate_proj.weight', 'addonsmallmodel.layers.6.mlp.gate_proj.weight', 'addonsmallmodel.layers.9.input_layernorm.weight', 'addonsmallmodel.layers.1.mlp.up_proj.weight', 'addonsmallmodel.layers.8.self_attn.o_proj.weight', 'addonsmallmodel.layers.8.mlp.up_proj.weight', 'addonsmallmodel.layers.3.mlp.down_proj.weight', 'addonsmallmodel.layers.3.self_attn.o_proj.weight', 'addonsmallmodel.norm.weight', 'addonsmallmodel.layers.9.self_attn.v_proj.weight', 'addonsmallmodel.layers.3.self_attn.k_proj.weight', 'addonsmallmodel.layers.0.input_layernorm.weight', 'addonsmallmodel.layers.1.self_attn.k_proj.weight', 'addonsmallmodel.layers.8.self_attn.k_proj.weight', 'addonsmallmodel.layers.0.mlp.gate_proj.weight', 'addonsmallmodel.layers.2.mlp.down_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Loading checkpoint shards: 100%|██████████| 2/2 [01:02<00:00, 26.20s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:02<00:00, 31.01s/it]
Some weights of LlamaWeirdLargeTest were not initialized from the model checkpoint at meta-llama/Llama-2-7b-hf and are newly initialized: ['addonsmallmodel.layers.11.self_attn.o_proj.weight', 'addonsmallmodel.layers.7.input_layernorm.weight', 'addonsmallmodel.embed_projection.weight', 'addonsmallmodel.layers.2.self_attn.o_proj.weight', 'addonsmallmodel.layers.1.self_attn.v_proj.weight', 'addonsmallmodel.layers.4.self_attn.o_proj.weight', 'addonsmallmodel.layers.10.input_layernorm.weight', 'addonsmallmodel.layers.6.mlp.gate_proj.weight', 'addonsmallmodel.layers.9.mlp.down_proj.weight', 'addonsmallmodel.layers.0.mlp.down_proj.weight', 'addonsmallmodel.layers.6.mlp.down_proj.weight', 'addonsmallmodel.layers.5.input_layernorm.weight', 'addonsmallmodel.layers.10.post_attention_layernorm.weight', 'addonsmallmodel.layers.9.self_attn.q_proj.weight', 'addonsmallmodel.layers.8.post_attention_layernorm.weight', 'addonsmallmodel.layers.3.mlp.down_proj.weight', 'addonsmallmodel.layers.3.self_attn.v_proj.weight', 'addonsmallmodel.layers.3.self_attn.o_proj.weight', 'addonsmallmodel.layers.3.self_attn.q_proj.weight', 'addonsmallmodel.layers.0.self_attn.o_proj.weight', 'addonsmallmodel.layers.9.mlp.gate_proj.weight', 'addonsmallmodel.layers.3.mlp.gate_proj.weight', 'addonsmallmodel.layers.3.self_attn.k_proj.weight', 'addonsmallmodel.layers.6.self_attn.q_proj.weight', 'addonsmallmodel.layers.4.mlp.gate_proj.weight', 'addonsmallmodel.layers.6.self_attn.k_proj.weight', 'addonsmallmodel.layers.5.self_attn.o_proj.weight', 'addonsmallmodel.layers.4.self_attn.v_proj.weight', 'addonsmallmodel.layers.7.self_attn.v_proj.weight', 'addonsmallmodel.layers.0.self_attn.q_proj.weight', 'addonsmallmodel.layers.2.self_attn.q_proj.weight', 'addonsmallmodel.layers.0.self_attn.v_proj.weight', 'addonsmallmodel.layers.4.post_attention_layernorm.weight', 'addonsmallmodel.layers.6.post_attention_layernorm.weight', 'addonsmallmodel.layers.7.self_attn.q_proj.weight', 'addonsmallmodel.layers.9.input_layernorm.weight', 'addonsmallmodel.layers.8.mlp.down_proj.weight', 'addonsmallmodel.layers.9.post_attention_layernorm.weight', 'addonsmallmodel.layers.0.self_attn.k_proj.weight', 'addonsmallmodel.layers.2.input_layernorm.weight', 'addonsmallmodel.layers.7.mlp.gate_proj.weight', 'addonsmallmodel.layers.5.mlp.down_proj.weight', 'addonsmallmodel.layers.10.self_attn.k_proj.weight', 'addonsmallmodel.layers.0.input_layernorm.weight', 'addonsmallmodel.layers.5.self_attn.k_proj.weight', 'addonsmallmodel.layers.7.mlp.down_proj.weight', 'addonsmallmodel.layers.8.mlp.gate_proj.weight', 'addonsmallmodel.layers.3.post_attention_layernorm.weight', 'addonsmallmodel.layers.5.post_attention_layernorm.weight', 'addonsmallmodel.lm_head.weight', 'addonsmallmodel.layers.11.mlp.down_proj.weight', 'addonsmallmodel.layers.2.mlp.up_proj.weight', 'addonsmallmodel.layers.8.mlp.up_proj.weight', 'addonsmallmodel.layers.8.input_layernorm.weight', 'addonsmallmodel.layers.11.self_attn.q_proj.weight', 'addonsmallmodel.layers.4.mlp.down_proj.weight', 'addonsmallmodel.layers.2.mlp.gate_proj.weight', 'addonsmallmodel.layers.1.self_attn.k_proj.weight', 'addonsmallmodel.layers.5.mlp.up_proj.weight', 'addonsmallmodel.layers.1.post_attention_layernorm.weight', 'addonsmallmodel.layers.11.mlp.gate_proj.weight', 'addonsmallmodel.layers.10.mlp.gate_proj.weight', 'addonsmallmodel.layers.4.input_layernorm.weight', 'addonsmallmodel.layers.0.post_attention_layernorm.weight', 'addonsmallmodel.layers.7.post_attention_layernorm.weight', 'addonsmallmodel.layers.4.self_attn.k_proj.weight', 'addonsmallmodel.layers.3.mlp.up_proj.weight', 'addonsmallmodel.layers.11.post_attention_layernorm.weight', 'addonsmallmodel.layers.5.self_attn.q_proj.weight', 'addonsmallmodel.layers.9.self_attn.o_proj.weight', 'addonsmallmodel.layers.6.mlp.up_proj.weight', 'addonsmallmodel.layers.9.self_attn.k_proj.weight', 'addonsmallmodel.layers.1.self_attn.o_proj.weight', 'addonsmallmodel.layers.10.self_attn.q_proj.weight', 'addonsmallmodel.embed_tokens.weight', 'addonsmallmodel.layers.2.mlp.down_proj.weight', 'addonsmallmodel.layers.1.mlp.down_proj.weight', 'addonsmallmodel.layers.7.mlp.up_proj.weight', 'addonsmallmodel.layers.3.input_layernorm.weight', 'addonsmallmodel.layers.4.self_attn.q_proj.weight', 'addonsmallmodel.layers.10.mlp.down_proj.weight', 'addonsmallmodel.layers.11.input_layernorm.weight', 'addonsmallmodel.layers.7.self_attn.o_proj.weight', 'addonsmallmodel.layers.2.self_attn.k_proj.weight', 'addonsmallmodel.layers.2.self_attn.v_proj.weight', 'addonsmallmodel.layers.1.mlp.up_proj.weight', 'addonsmallmodel.layers.8.self_attn.k_proj.weight', 'addonsmallmodel.layers.0.mlp.gate_proj.weight', 'addonsmallmodel.layers.11.mlp.up_proj.weight', 'addonsmallmodel.layers.8.self_attn.q_proj.weight', 'addonsmallmodel.layers.11.self_attn.v_proj.weight', 'addonsmallmodel.layers.6.self_attn.v_proj.weight', 'addonsmallmodel.layers.1.self_attn.q_proj.weight', 'addonsmallmodel.layers.9.mlp.up_proj.weight', 'addonsmallmodel.layers.2.post_attention_layernorm.weight', 'addonsmallmodel.norm.weight', 'addonsmallmodel.layers.8.self_attn.v_proj.weight', 'addonsmallmodel.layers.11.self_attn.k_proj.weight', 'addonsmallmodel.layers.5.mlp.gate_proj.weight', 'addonsmallmodel.layers.0.mlp.up_proj.weight', 'addonsmallmodel.layers.6.self_attn.o_proj.weight', 'addonsmallmodel.layers.5.self_attn.v_proj.weight', 'addonsmallmodel.layers.8.self_attn.o_proj.weight', 'addonsmallmodel.layers.1.input_layernorm.weight', 'addonsmallmodel.layers.7.self_attn.k_proj.weight', 'addonsmallmodel.layers.6.input_layernorm.weight', 'addonsmallmodel.layers.4.mlp.up_proj.weight', 'addonsmallmodel.layers.10.self_attn.v_proj.weight', 'addonsmallmodel.layers.1.mlp.gate_proj.weight', 'addonsmallmodel.layers.10.self_attn.o_proj.weight', 'addonsmallmodel.layers.9.self_attn.v_proj.weight', 'addonsmallmodel.layers.10.mlp.up_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Loading checkpoint shards: 100%|██████████| 2/2 [01:02<00:00, 26.22s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:02<00:00, 31.04s/it]
Some weights of LlamaWeirdLargeTest were not initialized from the model checkpoint at meta-llama/Llama-2-7b-hf and are newly initialized: ['addonsmallmodel.layers.5.mlp.up_proj.weight', 'addonsmallmodel.layers.10.input_layernorm.weight', 'addonsmallmodel.layers.6.input_layernorm.weight', 'addonsmallmodel.layers.7.self_attn.o_proj.weight', 'addonsmallmodel.layers.0.self_attn.k_proj.weight', 'addonsmallmodel.layers.7.mlp.down_proj.weight', 'addonsmallmodel.layers.4.self_attn.v_proj.weight', 'addonsmallmodel.layers.1.self_attn.o_proj.weight', 'addonsmallmodel.layers.11.self_attn.q_proj.weight', 'addonsmallmodel.layers.8.mlp.gate_proj.weight', 'addonsmallmodel.layers.8.self_attn.o_proj.weight', 'addonsmallmodel.layers.5.self_attn.k_proj.weight', 'addonsmallmodel.layers.1.post_attention_layernorm.weight', 'addonsmallmodel.layers.2.self_attn.q_proj.weight', 'addonsmallmodel.layers.7.post_attention_layernorm.weight', 'addonsmallmodel.layers.4.input_layernorm.weight', 'addonsmallmodel.layers.0.self_attn.q_proj.weight', 'addonsmallmodel.layers.10.self_attn.v_proj.weight', 'addonsmallmodel.layers.7.self_attn.k_proj.weight', 'addonsmallmodel.layers.8.mlp.up_proj.weight', 'addonsmallmodel.layers.8.self_attn.q_proj.weight', 'addonsmallmodel.layers.6.mlp.gate_proj.weight', 'addonsmallmodel.layers.6.mlp.down_proj.weight', 'addonsmallmodel.layers.1.self_attn.q_proj.weight', 'addonsmallmodel.layers.0.post_attention_layernorm.weight', 'addonsmallmodel.layers.8.self_attn.k_proj.weight', 'addonsmallmodel.layers.11.self_attn.o_proj.weight', 'addonsmallmodel.layers.11.mlp.down_proj.weight', 'addonsmallmodel.layers.5.self_attn.o_proj.weight', 'addonsmallmodel.layers.5.input_layernorm.weight', 'addonsmallmodel.layers.0.mlp.down_proj.weight', 'addonsmallmodel.lm_head.weight', 'addonsmallmodel.layers.1.self_attn.v_proj.weight', 'addonsmallmodel.layers.4.self_attn.k_proj.weight', 'addonsmallmodel.layers.10.post_attention_layernorm.weight', 'addonsmallmodel.layers.3.post_attention_layernorm.weight', 'addonsmallmodel.layers.6.self_attn.v_proj.weight', 'addonsmallmodel.layers.7.mlp.gate_proj.weight', 'addonsmallmodel.layers.6.self_attn.o_proj.weight', 'addonsmallmodel.layers.6.post_attention_layernorm.weight', 'addonsmallmodel.layers.10.self_attn.o_proj.weight', 'addonsmallmodel.layers.9.mlp.gate_proj.weight', 'addonsmallmodel.layers.4.post_attention_layernorm.weight', 'addonsmallmodel.layers.5.post_attention_layernorm.weight', 'addonsmallmodel.layers.6.mlp.up_proj.weight', 'addonsmallmodel.layers.5.self_attn.q_proj.weight', 'addonsmallmodel.layers.3.self_attn.k_proj.weight', 'addonsmallmodel.layers.3.input_layernorm.weight', 'addonsmallmodel.layers.8.post_attention_layernorm.weight', 'addonsmallmodel.layers.2.mlp.down_proj.weight', 'addonsmallmodel.layers.3.self_attn.q_proj.weight', 'addonsmallmodel.layers.2.input_layernorm.weight', 'addonsmallmodel.layers.3.mlp.up_proj.weight', 'addonsmallmodel.layers.9.mlp.down_proj.weight', 'addonsmallmodel.layers.2.self_attn.o_proj.weight', 'addonsmallmodel.layers.0.mlp.up_proj.weight', 'addonsmallmodel.layers.11.mlp.gate_proj.weight', 'addonsmallmodel.layers.9.self_attn.v_proj.weight', 'addonsmallmodel.layers.0.self_attn.v_proj.weight', 'addonsmallmodel.layers.5.mlp.down_proj.weight', 'addonsmallmodel.layers.2.post_attention_layernorm.weight', 'addonsmallmodel.embed_tokens.weight', 'addonsmallmodel.layers.11.self_attn.k_proj.weight', 'addonsmallmodel.layers.0.self_attn.o_proj.weight', 'addonsmallmodel.layers.11.input_layernorm.weight', 'addonsmallmodel.layers.1.mlp.up_proj.weight', 'addonsmallmodel.layers.2.self_attn.k_proj.weight', 'addonsmallmodel.layers.3.mlp.gate_proj.weight', 'addonsmallmodel.layers.10.self_attn.k_proj.weight', 'addonsmallmodel.layers.4.self_attn.q_proj.weight', 'addonsmallmodel.layers.7.self_attn.v_proj.weight', 'addonsmallmodel.layers.0.input_layernorm.weight', 'addonsmallmodel.layers.7.mlp.up_proj.weight', 'addonsmallmodel.embed_projection.weight', 'addonsmallmodel.layers.7.input_layernorm.weight', 'addonsmallmodel.layers.1.mlp.down_proj.weight', 'addonsmallmodel.layers.11.self_attn.v_proj.weight', 'addonsmallmodel.layers.9.mlp.up_proj.weight', 'addonsmallmodel.layers.3.mlp.down_proj.weight', 'addonsmallmodel.layers.0.mlp.gate_proj.weight', 'addonsmallmodel.layers.2.self_attn.v_proj.weight', 'addonsmallmodel.norm.weight', 'addonsmallmodel.layers.1.self_attn.k_proj.weight', 'addonsmallmodel.layers.7.self_attn.q_proj.weight', 'addonsmallmodel.layers.9.self_attn.q_proj.weight', 'addonsmallmodel.layers.3.self_attn.o_proj.weight', 'addonsmallmodel.layers.11.post_attention_layernorm.weight', 'addonsmallmodel.layers.11.mlp.up_proj.weight', 'addonsmallmodel.layers.10.mlp.gate_proj.weight', 'addonsmallmodel.layers.6.self_attn.q_proj.weight', 'addonsmallmodel.layers.8.input_layernorm.weight', 'addonsmallmodel.layers.10.self_attn.q_proj.weight', 'addonsmallmodel.layers.9.post_attention_layernorm.weight', 'addonsmallmodel.layers.9.self_attn.o_proj.weight', 'addonsmallmodel.layers.9.input_layernorm.weight', 'addonsmallmodel.layers.4.mlp.down_proj.weight', 'addonsmallmodel.layers.4.mlp.up_proj.weight', 'addonsmallmodel.layers.1.mlp.gate_proj.weight', 'addonsmallmodel.layers.10.mlp.down_proj.weight', 'addonsmallmodel.layers.2.mlp.up_proj.weight', 'addonsmallmodel.layers.3.self_attn.v_proj.weight', 'addonsmallmodel.layers.1.input_layernorm.weight', 'addonsmallmodel.layers.2.mlp.gate_proj.weight', 'addonsmallmodel.layers.8.self_attn.v_proj.weight', 'addonsmallmodel.layers.5.self_attn.v_proj.weight', 'addonsmallmodel.layers.9.self_attn.k_proj.weight', 'addonsmallmodel.layers.8.mlp.down_proj.weight', 'addonsmallmodel.layers.5.mlp.gate_proj.weight', 'addonsmallmodel.layers.6.self_attn.k_proj.weight', 'addonsmallmodel.layers.10.mlp.up_proj.weight', 'addonsmallmodel.layers.4.mlp.gate_proj.weight', 'addonsmallmodel.layers.4.self_attn.o_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Loading checkpoint shards: 100%|██████████| 2/2 [00:57<00:00, 24.76s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:57<00:00, 28.64s/it]
Some weights of LlamaWeirdLargeTest were not initialized from the model checkpoint at meta-llama/Llama-2-7b-hf and are newly initialized: ['addonsmallmodel.layers.8.mlp.down_proj.weight', 'addonsmallmodel.layers.0.self_attn.q_proj.weight', 'addonsmallmodel.layers.11.post_attention_layernorm.weight', 'addonsmallmodel.layers.4.mlp.down_proj.weight', 'addonsmallmodel.layers.11.mlp.gate_proj.weight', 'addonsmallmodel.layers.2.post_attention_layernorm.weight', 'addonsmallmodel.layers.1.mlp.gate_proj.weight', 'addonsmallmodel.layers.6.input_layernorm.weight', 'addonsmallmodel.layers.4.mlp.gate_proj.weight', 'addonsmallmodel.layers.4.mlp.up_proj.weight', 'addonsmallmodel.layers.5.post_attention_layernorm.weight', 'addonsmallmodel.layers.9.self_attn.o_proj.weight', 'addonsmallmodel.layers.11.input_layernorm.weight', 'addonsmallmodel.layers.8.post_attention_layernorm.weight', 'addonsmallmodel.layers.2.self_attn.v_proj.weight', 'addonsmallmodel.layers.9.input_layernorm.weight', 'addonsmallmodel.embed_projection.weight', 'addonsmallmodel.layers.5.self_attn.q_proj.weight', 'addonsmallmodel.layers.6.self_attn.o_proj.weight', 'addonsmallmodel.layers.7.mlp.gate_proj.weight', 'addonsmallmodel.layers.1.self_attn.v_proj.weight', 'addonsmallmodel.layers.7.input_layernorm.weight', 'addonsmallmodel.layers.8.self_attn.v_proj.weight', 'addonsmallmodel.layers.8.self_attn.q_proj.weight', 'addonsmallmodel.layers.11.mlp.up_proj.weight', 'addonsmallmodel.layers.4.input_layernorm.weight', 'addonsmallmodel.layers.0.input_layernorm.weight', 'addonsmallmodel.layers.6.mlp.up_proj.weight', 'addonsmallmodel.layers.2.self_attn.k_proj.weight', 'addonsmallmodel.layers.10.self_attn.q_proj.weight', 'addonsmallmodel.layers.3.self_attn.q_proj.weight', 'addonsmallmodel.layers.3.self_attn.o_proj.weight', 'addonsmallmodel.layers.10.mlp.gate_proj.weight', 'addonsmallmodel.layers.7.post_attention_layernorm.weight', 'addonsmallmodel.layers.9.self_attn.q_proj.weight', 'addonsmallmodel.layers.10.self_attn.v_proj.weight', 'addonsmallmodel.layers.1.self_attn.o_proj.weight', 'addonsmallmodel.layers.2.self_attn.o_proj.weight', 'addonsmallmodel.layers.1.self_attn.k_proj.weight', 'addonsmallmodel.layers.9.mlp.gate_proj.weight', 'addonsmallmodel.layers.11.self_attn.o_proj.weight', 'addonsmallmodel.layers.5.self_attn.k_proj.weight', 'addonsmallmodel.layers.6.mlp.gate_proj.weight', 'addonsmallmodel.layers.0.mlp.gate_proj.weight', 'addonsmallmodel.layers.11.self_attn.v_proj.weight', 'addonsmallmodel.layers.0.post_attention_layernorm.weight', 'addonsmallmodel.layers.5.self_attn.o_proj.weight', 'addonsmallmodel.layers.9.self_attn.v_proj.weight', 'addonsmallmodel.layers.5.self_attn.v_proj.weight', 'addonsmallmodel.layers.3.mlp.gate_proj.weight', 'addonsmallmodel.layers.11.self_attn.q_proj.weight', 'addonsmallmodel.layers.2.input_layernorm.weight', 'addonsmallmodel.layers.3.self_attn.v_proj.weight', 'addonsmallmodel.layers.0.self_attn.v_proj.weight', 'addonsmallmodel.layers.6.self_attn.k_proj.weight', 'addonsmallmodel.layers.7.self_attn.v_proj.weight', 'addonsmallmodel.layers.8.mlp.up_proj.weight', 'addonsmallmodel.layers.3.mlp.up_proj.weight', 'addonsmallmodel.layers.2.self_attn.q_proj.weight', 'addonsmallmodel.layers.2.mlp.up_proj.weight', 'addonsmallmodel.layers.11.self_attn.k_proj.weight', 'addonsmallmodel.layers.10.mlp.down_proj.weight', 'addonsmallmodel.layers.8.self_attn.o_proj.weight', 'addonsmallmodel.norm.weight', 'addonsmallmodel.layers.3.self_attn.k_proj.weight', 'addonsmallmodel.layers.0.mlp.up_proj.weight', 'addonsmallmodel.layers.10.mlp.up_proj.weight', 'addonsmallmodel.layers.7.self_attn.q_proj.weight', 'addonsmallmodel.layers.9.mlp.up_proj.weight', 'addonsmallmodel.layers.1.self_attn.q_proj.weight', 'addonsmallmodel.layers.2.mlp.down_proj.weight', 'addonsmallmodel.layers.6.self_attn.v_proj.weight', 'addonsmallmodel.layers.3.mlp.down_proj.weight', 'addonsmallmodel.layers.10.self_attn.k_proj.weight', 'addonsmallmodel.layers.1.post_attention_layernorm.weight', 'addonsmallmodel.layers.9.mlp.down_proj.weight', 'addonsmallmodel.layers.6.self_attn.q_proj.weight', 'addonsmallmodel.layers.10.post_attention_layernorm.weight', 'addonsmallmodel.layers.4.self_attn.o_proj.weight', 'addonsmallmodel.layers.0.self_attn.k_proj.weight', 'addonsmallmodel.layers.0.mlp.down_proj.weight', 'addonsmallmodel.layers.7.self_attn.k_proj.weight', 'addonsmallmodel.layers.5.mlp.gate_proj.weight', 'addonsmallmodel.embed_tokens.weight', 'addonsmallmodel.layers.9.post_attention_layernorm.weight', 'addonsmallmodel.layers.10.self_attn.o_proj.weight', 'addonsmallmodel.layers.6.post_attention_layernorm.weight', 'addonsmallmodel.layers.3.input_layernorm.weight', 'addonsmallmodel.layers.4.self_attn.q_proj.weight', 'addonsmallmodel.layers.2.mlp.gate_proj.weight', 'addonsmallmodel.layers.1.mlp.up_proj.weight', 'addonsmallmodel.layers.8.mlp.gate_proj.weight', 'addonsmallmodel.layers.0.self_attn.o_proj.weight', 'addonsmallmodel.layers.7.mlp.down_proj.weight', 'addonsmallmodel.layers.4.self_attn.k_proj.weight', 'addonsmallmodel.layers.5.input_layernorm.weight', 'addonsmallmodel.layers.9.self_attn.k_proj.weight', 'addonsmallmodel.layers.8.input_layernorm.weight', 'addonsmallmodel.layers.1.mlp.down_proj.weight', 'addonsmallmodel.layers.4.self_attn.v_proj.weight', 'addonsmallmodel.lm_head.weight', 'addonsmallmodel.layers.4.post_attention_layernorm.weight', 'addonsmallmodel.layers.5.mlp.up_proj.weight', 'addonsmallmodel.layers.5.mlp.down_proj.weight', 'addonsmallmodel.layers.7.mlp.up_proj.weight', 'addonsmallmodel.layers.6.mlp.down_proj.weight', 'addonsmallmodel.layers.8.self_attn.k_proj.weight', 'addonsmallmodel.layers.3.post_attention_layernorm.weight', 'addonsmallmodel.layers.11.mlp.down_proj.weight', 'addonsmallmodel.layers.1.input_layernorm.weight', 'addonsmallmodel.layers.10.input_layernorm.weight', 'addonsmallmodel.layers.7.self_attn.o_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Loading checkpoint shards: 100%|██████████| 2/2 [01:02<00:00, 26.27s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:02<00:00, 31.08s/it]
Some weights of LlamaWeirdLargeTest were not initialized from the model checkpoint at meta-llama/Llama-2-7b-hf and are newly initialized: ['addonsmallmodel.layers.5.input_layernorm.weight', 'addonsmallmodel.layers.9.self_attn.v_proj.weight', 'addonsmallmodel.layers.1.post_attention_layernorm.weight', 'addonsmallmodel.layers.4.input_layernorm.weight', 'addonsmallmodel.layers.11.mlp.gate_proj.weight', 'addonsmallmodel.layers.2.mlp.gate_proj.weight', 'addonsmallmodel.layers.9.post_attention_layernorm.weight', 'addonsmallmodel.layers.2.input_layernorm.weight', 'addonsmallmodel.layers.0.self_attn.o_proj.weight', 'addonsmallmodel.layers.7.self_attn.o_proj.weight', 'addonsmallmodel.layers.10.self_attn.q_proj.weight', 'addonsmallmodel.layers.7.mlp.down_proj.weight', 'addonsmallmodel.layers.10.self_attn.o_proj.weight', 'addonsmallmodel.lm_head.weight', 'addonsmallmodel.layers.3.self_attn.q_proj.weight', 'addonsmallmodel.layers.3.mlp.up_proj.weight', 'addonsmallmodel.layers.4.mlp.up_proj.weight', 'addonsmallmodel.layers.11.self_attn.k_proj.weight', 'addonsmallmodel.layers.7.mlp.up_proj.weight', 'addonsmallmodel.layers.5.self_attn.k_proj.weight', 'addonsmallmodel.layers.6.mlp.gate_proj.weight', 'addonsmallmodel.layers.4.mlp.down_proj.weight', 'addonsmallmodel.layers.2.self_attn.k_proj.weight', 'addonsmallmodel.layers.9.self_attn.k_proj.weight', 'addonsmallmodel.layers.8.self_attn.o_proj.weight', 'addonsmallmodel.layers.2.mlp.down_proj.weight', 'addonsmallmodel.layers.5.self_attn.o_proj.weight', 'addonsmallmodel.layers.11.self_attn.v_proj.weight', 'addonsmallmodel.layers.8.mlp.gate_proj.weight', 'addonsmallmodel.layers.7.self_attn.v_proj.weight', 'addonsmallmodel.layers.3.post_attention_layernorm.weight', 'addonsmallmodel.layers.3.mlp.gate_proj.weight', 'addonsmallmodel.layers.1.input_layernorm.weight', 'addonsmallmodel.layers.1.self_attn.v_proj.weight', 'addonsmallmodel.layers.11.mlp.down_proj.weight', 'addonsmallmodel.layers.6.self_attn.o_proj.weight', 'addonsmallmodel.layers.4.self_attn.v_proj.weight', 'addonsmallmodel.layers.3.mlp.down_proj.weight', 'addonsmallmodel.layers.4.self_attn.q_proj.weight', 'addonsmallmodel.layers.0.mlp.gate_proj.weight', 'addonsmallmodel.layers.6.self_attn.k_proj.weight', 'addonsmallmodel.layers.6.post_attention_layernorm.weight', 'addonsmallmodel.layers.3.self_attn.v_proj.weight', 'addonsmallmodel.layers.10.mlp.up_proj.weight', 'addonsmallmodel.layers.6.mlp.down_proj.weight', 'addonsmallmodel.layers.2.self_attn.v_proj.weight', 'addonsmallmodel.layers.8.input_layernorm.weight', 'addonsmallmodel.layers.5.self_attn.q_proj.weight', 'addonsmallmodel.layers.2.self_attn.q_proj.weight', 'addonsmallmodel.layers.2.self_attn.o_proj.weight', 'addonsmallmodel.layers.5.mlp.down_proj.weight', 'addonsmallmodel.layers.7.input_layernorm.weight', 'addonsmallmodel.layers.8.mlp.up_proj.weight', 'addonsmallmodel.layers.6.self_attn.q_proj.weight', 'addonsmallmodel.layers.9.mlp.up_proj.weight', 'addonsmallmodel.layers.1.mlp.up_proj.weight', 'addonsmallmodel.layers.0.input_layernorm.weight', 'addonsmallmodel.layers.4.post_attention_layernorm.weight', 'addonsmallmodel.layers.3.self_attn.k_proj.weight', 'addonsmallmodel.layers.10.self_attn.k_proj.weight', 'addonsmallmodel.layers.0.mlp.up_proj.weight', 'addonsmallmodel.layers.10.mlp.down_proj.weight', 'addonsmallmodel.layers.7.self_attn.q_proj.weight', 'addonsmallmodel.layers.6.self_attn.v_proj.weight', 'addonsmallmodel.layers.8.self_attn.v_proj.weight', 'addonsmallmodel.embed_tokens.weight', 'addonsmallmodel.layers.5.self_attn.v_proj.weight', 'addonsmallmodel.layers.9.mlp.down_proj.weight', 'addonsmallmodel.layers.3.self_attn.o_proj.weight', 'addonsmallmodel.layers.1.mlp.down_proj.weight', 'addonsmallmodel.embed_projection.weight', 'addonsmallmodel.layers.7.mlp.gate_proj.weight', 'addonsmallmodel.layers.1.self_attn.o_proj.weight', 'addonsmallmodel.layers.11.self_attn.o_proj.weight', 'addonsmallmodel.layers.9.input_layernorm.weight', 'addonsmallmodel.layers.1.self_attn.k_proj.weight', 'addonsmallmodel.layers.6.input_layernorm.weight', 'addonsmallmodel.layers.2.post_attention_layernorm.weight', 'addonsmallmodel.layers.0.self_attn.v_proj.weight', 'addonsmallmodel.layers.5.mlp.up_proj.weight', 'addonsmallmodel.layers.0.self_attn.k_proj.weight', 'addonsmallmodel.layers.1.self_attn.q_proj.weight', 'addonsmallmodel.layers.10.post_attention_layernorm.weight', 'addonsmallmodel.layers.4.self_attn.o_proj.weight', 'addonsmallmodel.layers.11.mlp.up_proj.weight', 'addonsmallmodel.layers.8.self_attn.k_proj.weight', 'addonsmallmodel.layers.7.post_attention_layernorm.weight', 'addonsmallmodel.layers.2.mlp.up_proj.weight', 'addonsmallmodel.layers.10.self_attn.v_proj.weight', 'addonsmallmodel.layers.9.self_attn.o_proj.weight', 'addonsmallmodel.norm.weight', 'addonsmallmodel.layers.4.mlp.gate_proj.weight', 'addonsmallmodel.layers.0.post_attention_layernorm.weight', 'addonsmallmodel.layers.8.post_attention_layernorm.weight', 'addonsmallmodel.layers.8.mlp.down_proj.weight', 'addonsmallmodel.layers.11.input_layernorm.weight', 'addonsmallmodel.layers.10.mlp.gate_proj.weight', 'addonsmallmodel.layers.9.mlp.gate_proj.weight', 'addonsmallmodel.layers.9.self_attn.q_proj.weight', 'addonsmallmodel.layers.0.mlp.down_proj.weight', 'addonsmallmodel.layers.5.mlp.gate_proj.weight', 'addonsmallmodel.layers.1.mlp.gate_proj.weight', 'addonsmallmodel.layers.7.self_attn.k_proj.weight', 'addonsmallmodel.layers.3.input_layernorm.weight', 'addonsmallmodel.layers.5.post_attention_layernorm.weight', 'addonsmallmodel.layers.11.self_attn.q_proj.weight', 'addonsmallmodel.layers.10.input_layernorm.weight', 'addonsmallmodel.layers.4.self_attn.k_proj.weight', 'addonsmallmodel.layers.0.self_attn.q_proj.weight', 'addonsmallmodel.layers.8.self_attn.q_proj.weight', 'addonsmallmodel.layers.6.mlp.up_proj.weight', 'addonsmallmodel.layers.11.post_attention_layernorm.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Loading checkpoint shards: 100%|██████████| 2/2 [00:29<00:00, 12.93s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:29<00:00, 14.58s/it]
Some weights of LlamaWeirdLargeTest were not initialized from the model checkpoint at meta-llama/Llama-2-7b-hf and are newly initialized: ['addonsmallmodel.layers.4.self_attn.o_proj.weight', 'addonsmallmodel.layers.2.mlp.up_proj.weight', 'addonsmallmodel.layers.6.mlp.up_proj.weight', 'addonsmallmodel.layers.8.input_layernorm.weight', 'addonsmallmodel.layers.4.mlp.gate_proj.weight', 'addonsmallmodel.layers.8.self_attn.q_proj.weight', 'addonsmallmodel.layers.9.input_layernorm.weight', 'addonsmallmodel.layers.4.input_layernorm.weight', 'addonsmallmodel.layers.10.input_layernorm.weight', 'addonsmallmodel.layers.0.self_attn.o_proj.weight', 'addonsmallmodel.layers.2.self_attn.v_proj.weight', 'addonsmallmodel.layers.0.post_attention_layernorm.weight', 'addonsmallmodel.layers.11.post_attention_layernorm.weight', 'addonsmallmodel.layers.1.self_attn.k_proj.weight', 'addonsmallmodel.layers.10.post_attention_layernorm.weight', 'addonsmallmodel.embed_tokens.weight', 'addonsmallmodel.layers.9.mlp.down_proj.weight', 'addonsmallmodel.layers.2.self_attn.k_proj.weight', 'addonsmallmodel.layers.2.input_layernorm.weight', 'addonsmallmodel.layers.6.mlp.down_proj.weight', 'addonsmallmodel.layers.1.self_attn.o_proj.weight', 'addonsmallmodel.layers.3.input_layernorm.weight', 'addonsmallmodel.layers.11.self_attn.v_proj.weight', 'addonsmallmodel.layers.8.self_attn.v_proj.weight', 'addonsmallmodel.layers.2.post_attention_layernorm.weight', 'addonsmallmodel.layers.1.mlp.up_proj.weight', 'addonsmallmodel.layers.9.self_attn.v_proj.weight', 'addonsmallmodel.layers.3.mlp.gate_proj.weight', 'addonsmallmodel.layers.0.input_layernorm.weight', 'addonsmallmodel.layers.5.self_attn.v_proj.weight', 'addonsmallmodel.layers.11.self_attn.o_proj.weight', 'addonsmallmodel.layers.9.self_attn.k_proj.weight', 'addonsmallmodel.layers.10.self_attn.k_proj.weight', 'addonsmallmodel.layers.2.self_attn.q_proj.weight', 'addonsmallmodel.layers.0.self_attn.v_proj.weight', 'addonsmallmodel.layers.6.self_attn.v_proj.weight', 'addonsmallmodel.layers.4.mlp.up_proj.weight', 'addonsmallmodel.layers.10.mlp.gate_proj.weight', 'addonsmallmodel.layers.3.mlp.down_proj.weight', 'addonsmallmodel.layers.8.self_attn.o_proj.weight', 'addonsmallmodel.layers.6.input_layernorm.weight', 'addonsmallmodel.layers.5.self_attn.q_proj.weight', 'addonsmallmodel.layers.7.mlp.down_proj.weight', 'addonsmallmodel.layers.1.input_layernorm.weight', 'addonsmallmodel.layers.8.mlp.down_proj.weight', 'addonsmallmodel.layers.7.mlp.gate_proj.weight', 'addonsmallmodel.layers.10.mlp.up_proj.weight', 'addonsmallmodel.layers.3.mlp.up_proj.weight', 'addonsmallmodel.layers.7.self_attn.o_proj.weight', 'addonsmallmodel.layers.10.self_attn.o_proj.weight', 'addonsmallmodel.layers.7.self_attn.k_proj.weight', 'addonsmallmodel.layers.9.self_attn.o_proj.weight', 'addonsmallmodel.layers.8.post_attention_layernorm.weight', 'addonsmallmodel.layers.10.mlp.down_proj.weight', 'addonsmallmodel.embed_projection.weight', 'addonsmallmodel.layers.5.mlp.up_proj.weight', 'addonsmallmodel.layers.5.input_layernorm.weight', 'addonsmallmodel.layers.7.post_attention_layernorm.weight', 'addonsmallmodel.layers.7.self_attn.v_proj.weight', 'addonsmallmodel.layers.2.mlp.gate_proj.weight', 'addonsmallmodel.layers.7.input_layernorm.weight', 'addonsmallmodel.layers.1.post_attention_layernorm.weight', 'addonsmallmodel.layers.3.self_attn.q_proj.weight', 'addonsmallmodel.layers.9.post_attention_layernorm.weight', 'addonsmallmodel.layers.5.self_attn.o_proj.weight', 'addonsmallmodel.layers.3.self_attn.k_proj.weight', 'addonsmallmodel.layers.0.mlp.up_proj.weight', 'addonsmallmodel.layers.4.post_attention_layernorm.weight', 'addonsmallmodel.layers.1.self_attn.q_proj.weight', 'addonsmallmodel.layers.6.self_attn.k_proj.weight', 'addonsmallmodel.layers.4.mlp.down_proj.weight', 'addonsmallmodel.layers.11.input_layernorm.weight', 'addonsmallmodel.layers.9.mlp.up_proj.weight', 'addonsmallmodel.layers.6.self_attn.o_proj.weight', 'addonsmallmodel.layers.8.self_attn.k_proj.weight', 'addonsmallmodel.lm_head.weight', 'addonsmallmodel.layers.0.self_attn.k_proj.weight', 'addonsmallmodel.layers.5.mlp.gate_proj.weight', 'addonsmallmodel.layers.9.self_attn.q_proj.weight', 'addonsmallmodel.layers.11.mlp.up_proj.weight', 'addonsmallmodel.layers.3.self_attn.v_proj.weight', 'addonsmallmodel.layers.10.self_attn.q_proj.weight', 'addonsmallmodel.layers.11.mlp.down_proj.weight', 'addonsmallmodel.layers.3.self_attn.o_proj.weight', 'addonsmallmodel.layers.4.self_attn.v_proj.weight', 'addonsmallmodel.layers.7.mlp.up_proj.weight', 'addonsmallmodel.layers.1.mlp.gate_proj.weight', 'addonsmallmodel.layers.1.mlp.down_proj.weight', 'addonsmallmodel.layers.5.self_attn.k_proj.weight', 'addonsmallmodel.layers.4.self_attn.q_proj.weight', 'addonsmallmodel.layers.5.mlp.down_proj.weight', 'addonsmallmodel.layers.0.mlp.down_proj.weight', 'addonsmallmodel.layers.8.mlp.up_proj.weight', 'addonsmallmodel.layers.0.self_attn.q_proj.weight', 'addonsmallmodel.layers.6.self_attn.q_proj.weight', 'addonsmallmodel.layers.10.self_attn.v_proj.weight', 'addonsmallmodel.layers.5.post_attention_layernorm.weight', 'addonsmallmodel.layers.11.mlp.gate_proj.weight', 'addonsmallmodel.layers.0.mlp.gate_proj.weight', 'addonsmallmodel.layers.2.mlp.down_proj.weight', 'addonsmallmodel.layers.11.self_attn.q_proj.weight', 'addonsmallmodel.layers.11.self_attn.k_proj.weight', 'addonsmallmodel.norm.weight', 'addonsmallmodel.layers.8.mlp.gate_proj.weight', 'addonsmallmodel.layers.4.self_attn.k_proj.weight', 'addonsmallmodel.layers.7.self_attn.q_proj.weight', 'addonsmallmodel.layers.3.post_attention_layernorm.weight', 'addonsmallmodel.layers.6.mlp.gate_proj.weight', 'addonsmallmodel.layers.6.post_attention_layernorm.weight', 'addonsmallmodel.layers.1.self_attn.v_proj.weight', 'addonsmallmodel.layers.9.mlp.gate_proj.weight', 'addonsmallmodel.layers.2.self_attn.o_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Loading checkpoint shards: 100%|██████████| 2/2 [00:30<00:00, 13.75s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:30<00:00, 15.30s/it]
Some weights of LlamaWeirdLargeTest were not initialized from the model checkpoint at meta-llama/Llama-2-7b-hf and are newly initialized: ['addonsmallmodel.layers.11.mlp.gate_proj.weight', 'addonsmallmodel.layers.9.self_attn.k_proj.weight', 'addonsmallmodel.layers.5.self_attn.q_proj.weight', 'addonsmallmodel.layers.6.self_attn.q_proj.weight', 'addonsmallmodel.layers.5.mlp.gate_proj.weight', 'addonsmallmodel.layers.4.self_attn.k_proj.weight', 'addonsmallmodel.layers.10.mlp.gate_proj.weight', 'addonsmallmodel.lm_head.weight', 'addonsmallmodel.layers.0.input_layernorm.weight', 'addonsmallmodel.layers.1.mlp.gate_proj.weight', 'addonsmallmodel.layers.5.post_attention_layernorm.weight', 'addonsmallmodel.layers.2.input_layernorm.weight', 'addonsmallmodel.layers.0.self_attn.v_proj.weight', 'addonsmallmodel.layers.7.mlp.gate_proj.weight', 'addonsmallmodel.layers.6.self_attn.k_proj.weight', 'addonsmallmodel.layers.10.post_attention_layernorm.weight', 'addonsmallmodel.layers.3.mlp.up_proj.weight', 'addonsmallmodel.layers.7.mlp.down_proj.weight', 'addonsmallmodel.layers.3.mlp.gate_proj.weight', 'addonsmallmodel.layers.2.post_attention_layernorm.weight', 'addonsmallmodel.layers.10.self_attn.k_proj.weight', 'addonsmallmodel.embed_tokens.weight', 'addonsmallmodel.layers.8.post_attention_layernorm.weight', 'addonsmallmodel.layers.9.self_attn.v_proj.weight', 'addonsmallmodel.layers.9.input_layernorm.weight', 'addonsmallmodel.layers.4.mlp.down_proj.weight', 'addonsmallmodel.layers.0.self_attn.q_proj.weight', 'addonsmallmodel.layers.0.mlp.down_proj.weight', 'addonsmallmodel.layers.6.post_attention_layernorm.weight', 'addonsmallmodel.layers.2.self_attn.q_proj.weight', 'addonsmallmodel.layers.5.self_attn.v_proj.weight', 'addonsmallmodel.layers.6.self_attn.o_proj.weight', 'addonsmallmodel.layers.3.self_attn.o_proj.weight', 'addonsmallmodel.layers.3.self_attn.q_proj.weight', 'addonsmallmodel.layers.1.self_attn.k_proj.weight', 'addonsmallmodel.layers.8.self_attn.v_proj.weight', 'addonsmallmodel.layers.11.post_attention_layernorm.weight', 'addonsmallmodel.layers.8.input_layernorm.weight', 'addonsmallmodel.layers.6.self_attn.v_proj.weight', 'addonsmallmodel.layers.7.post_attention_layernorm.weight', 'addonsmallmodel.layers.11.mlp.up_proj.weight', 'addonsmallmodel.layers.8.mlp.gate_proj.weight', 'addonsmallmodel.layers.9.self_attn.o_proj.weight', 'addonsmallmodel.layers.6.mlp.down_proj.weight', 'addonsmallmodel.layers.3.self_attn.v_proj.weight', 'addonsmallmodel.layers.11.mlp.down_proj.weight', 'addonsmallmodel.layers.2.self_attn.v_proj.weight', 'addonsmallmodel.layers.5.self_attn.k_proj.weight', 'addonsmallmodel.layers.2.self_attn.k_proj.weight', 'addonsmallmodel.layers.5.input_layernorm.weight', 'addonsmallmodel.layers.3.self_attn.k_proj.weight', 'addonsmallmodel.layers.4.self_attn.v_proj.weight', 'addonsmallmodel.layers.6.mlp.up_proj.weight', 'addonsmallmodel.layers.8.self_attn.o_proj.weight', 'addonsmallmodel.layers.9.mlp.gate_proj.weight', 'addonsmallmodel.layers.1.post_attention_layernorm.weight', 'addonsmallmodel.layers.10.mlp.down_proj.weight', 'addonsmallmodel.layers.5.mlp.down_proj.weight', 'addonsmallmodel.layers.0.self_attn.o_proj.weight', 'addonsmallmodel.layers.2.self_attn.o_proj.weight', 'addonsmallmodel.norm.weight', 'addonsmallmodel.layers.9.self_attn.q_proj.weight', 'addonsmallmodel.layers.10.input_layernorm.weight', 'addonsmallmodel.layers.0.post_attention_layernorm.weight', 'addonsmallmodel.layers.10.mlp.up_proj.weight', 'addonsmallmodel.layers.7.mlp.up_proj.weight', 'addonsmallmodel.layers.1.mlp.down_proj.weight', 'addonsmallmodel.layers.8.self_attn.q_proj.weight', 'addonsmallmodel.embed_projection.weight', 'addonsmallmodel.layers.8.self_attn.k_proj.weight', 'addonsmallmodel.layers.9.mlp.down_proj.weight', 'addonsmallmodel.layers.4.post_attention_layernorm.weight', 'addonsmallmodel.layers.4.self_attn.o_proj.weight', 'addonsmallmodel.layers.3.post_attention_layernorm.weight', 'addonsmallmodel.layers.1.mlp.up_proj.weight', 'addonsmallmodel.layers.2.mlp.gate_proj.weight', 'addonsmallmodel.layers.9.mlp.up_proj.weight', 'addonsmallmodel.layers.1.self_attn.v_proj.weight', 'addonsmallmodel.layers.6.mlp.gate_proj.weight', 'addonsmallmodel.layers.7.input_layernorm.weight', 'addonsmallmodel.layers.4.mlp.up_proj.weight', 'addonsmallmodel.layers.3.input_layernorm.weight', 'addonsmallmodel.layers.7.self_attn.k_proj.weight', 'addonsmallmodel.layers.1.input_layernorm.weight', 'addonsmallmodel.layers.6.input_layernorm.weight', 'addonsmallmodel.layers.11.self_attn.v_proj.weight', 'addonsmallmodel.layers.7.self_attn.o_proj.weight', 'addonsmallmodel.layers.11.self_attn.k_proj.weight', 'addonsmallmodel.layers.2.mlp.up_proj.weight', 'addonsmallmodel.layers.8.mlp.up_proj.weight', 'addonsmallmodel.layers.0.self_attn.k_proj.weight', 'addonsmallmodel.layers.10.self_attn.o_proj.weight', 'addonsmallmodel.layers.8.mlp.down_proj.weight', 'addonsmallmodel.layers.10.self_attn.v_proj.weight', 'addonsmallmodel.layers.11.input_layernorm.weight', 'addonsmallmodel.layers.7.self_attn.v_proj.weight', 'addonsmallmodel.layers.1.self_attn.o_proj.weight', 'addonsmallmodel.layers.0.mlp.up_proj.weight', 'addonsmallmodel.layers.1.self_attn.q_proj.weight', 'addonsmallmodel.layers.10.self_attn.q_proj.weight', 'addonsmallmodel.layers.4.input_layernorm.weight', 'addonsmallmodel.layers.7.self_attn.q_proj.weight', 'addonsmallmodel.layers.9.post_attention_layernorm.weight', 'addonsmallmodel.layers.4.self_attn.q_proj.weight', 'addonsmallmodel.layers.4.mlp.gate_proj.weight', 'addonsmallmodel.layers.11.self_attn.o_proj.weight', 'addonsmallmodel.layers.0.mlp.gate_proj.weight', 'addonsmallmodel.layers.5.self_attn.o_proj.weight', 'addonsmallmodel.layers.2.mlp.down_proj.weight', 'addonsmallmodel.layers.11.self_attn.q_proj.weight', 'addonsmallmodel.layers.5.mlp.up_proj.weight', 'addonsmallmodel.layers.3.mlp.down_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/transformersprofiling/weird_training_addingextralarge.py", line 1364, in <module>
    large_model = LlamaWeirdLargeTest.from_pretrained("meta-llama/Llama-2-7b-hf", cache_dir = dir_models).to(torch.bfloat16).to(torch_device) 
  File "/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/transformersprofiling/src/transformers/modeling_utils.py", line 2303, in to
    return super().to(*args, **kwargs)
  File "/data/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
  File "/data/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/data/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/data/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  [Previous line repeated 2 more times]
  File "/data/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
  File "/data/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 86.00 MiB. GPU 0 has a total capacty of 79.33 GiB of which 6.94 MiB is free. Process 4024736 has 13.35 GiB memory in use. Process 4024743 has 13.35 GiB memory in use. Process 4024737 has 13.35 GiB memory in use. Process 4024741 has 13.35 GiB memory in use. Process 4024742 has 13.35 GiB memory in use. Including non-PyTorch memory, this process has 12.52 GiB memory in use. Of the allocated memory 12.12 GiB is allocated by PyTorch, and 1.50 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-04-06 20:07:00,283] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 4024736 closing signal SIGTERM
[2024-04-06 20:07:00,283] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 4024737 closing signal SIGTERM
[2024-04-06 20:07:00,284] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 4024738 closing signal SIGTERM
[2024-04-06 20:07:00,284] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 4024740 closing signal SIGTERM
[2024-04-06 20:07:00,284] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 4024741 closing signal SIGTERM
[2024-04-06 20:07:00,284] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 4024742 closing signal SIGTERM
[2024-04-06 20:07:00,284] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 4024743 closing signal SIGTERM
[2024-04-06 20:07:01,845] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 3 (pid: 4024739) of binary: /data/home/beidic/anaconda3/envs/yangllm2/bin/python3.9
Traceback (most recent call last):
  File "/data/home/beidic/anaconda3/envs/yangllm2/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/data/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/data/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages/accelerate/commands/launch.py", line 1014, in launch_command
    multi_gpu_launcher(args)
  File "/data/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages/accelerate/commands/launch.py", line 672, in multi_gpu_launcher
    distrib_run.run(args)
  File "/data/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages/torch/distributed/run.py", line 797, in run
    elastic_launch(
  File "/data/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/data/home/beidic/anaconda3/envs/yangllm2/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 264, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
weird_training_addingextralarge.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-04-06_20:07:00
  host      : a100-st-p4de24xlarge-1027.fair-a100.hpcaas
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 4024739)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
